<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.5.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.5.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.5.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.5.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="OCaml Notes, CSCI 2041, DNA of programming languages.">
<meta name="keywords" content="Programming,Ocaml,Functional Programming">
<meta property="og:type" content="article">
<meta property="og:title" content="OCaml Learning Notes">
<meta property="og:url" content="http://yoursite.com/2019/09/12/OCaml Learning Notes/index.html">
<meta property="og:site_name" content="Qingliu">
<meta property="og:description" content="OCaml Notes, CSCI 2041, DNA of programming languages.">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-11-14T05:54:41.583Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="OCaml Learning Notes">
<meta name="twitter:description" content="OCaml Notes, CSCI 2041, DNA of programming languages.">






  <link rel="canonical" href="http://yoursite.com/2019/09/12/OCaml Learning Notes/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>OCaml Learning Notes | Qingliu</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

<a href="https://github.com/Aden-Q" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Qingliu</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/12/OCaml Learning Notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qingliu">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Qingliu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">OCaml Learning Notes
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-09-12 18:54:34" itemprop="dateCreated datePublished" datetime="2019-09-12T18:54:34-05:00">2019-09-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-11-13 23:54:41" itemprop="dateModified" datetime="2019-11-13T23:54:41-06:00">2019-11-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Note/" itemprop="url" rel="index"><span itemprop="name">Note</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/09/12/OCaml Learning Notes/" class="leancloud_visitors" data-flag-title="OCaml Learning Notes">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Heat: </span>
               
                 <span class="leancloud-visitors-count"></span>
                 <span>℃</span>
             </span>
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             Views:  
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>OCaml Notes, CSCI 2041, DNA of programming languages.</p>
<a id="more"></a>
<h1 id="Part-1-Basics"><a href="#Part-1-Basics" class="headerlink" title="Part 1: Basics"></a>Part 1: Basics</h1><p>Part 1 is a basic introduction of OCaml syntax and characteristics as a functional language. Also we introduce some mechanism such as <strong>pattern matching</strong> and <strong>polymorphism</strong> to make it distinguished.</p>
<p>First of all, the best REPL choice is <code>utop</code> program running under the terminal. Under this interactive environment, the OCaml phrases terminated with <code>;;</code> will be evaluated. User inputs (system command) are specified with <code>#</code>  at the beginning.</p>
<p>Type assertion: <code>exp : typ</code>. The type assertion is said to be valid iff the expression <code>exp</code> has type <code>typ</code>.</p>
<h2 id="Binding"><a href="#Binding" class="headerlink" title="Binding"></a>Binding</h2><p>Binding is permanent and can not be changed within specific scope of the program (normally the global scope).</p>
<p>Syntax of <strong>type binding</strong>:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> tycon = typ</span><br></pre></td></tr></table></figure>
<p>Semantics: <code>tycon</code> is a type constructor, bound to type <code>typ</code></p>
<p>Syntax of <strong>value binding</strong>:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> var : typ = exp</span><br></pre></td></tr></table></figure>
<p>Semantics: <code>var</code> is a variable, introduced the type <code>typ</code> and value <code>exp</code>. Notice that we must specify both the type and value of this type. There will be type-checking when binding, if succeed, expression <code>exp</code> will be evaluated first, and then its value is bound to variable <code>var</code>. If <code>exp</code> does not have a value, then binding never happens. (Notice that <code>None</code> is a value.)</p>
<p>Variable name must start with a lowercase letter or an underscore and excludes other punctuations.</p>
<p><strong>Purpose of binding</strong>: Make a variable or type constructor available for use within its scope.</p>
<p><strong>Substitution principle</strong>: A bound variable or type constructor is implicitly <em>replaced</em> by its binding prior to type checking and evaluation.</p>
<p><strong>Compound Declarations (Bindings)</strong>: This is defined by sequential bindings of the form <em>dec1, dec2, …decn</em>, with nested scope.</p>
<p><strong>Binding is not assignment</strong>: The binding of a variable never changes, once bound to a value, it is always bound to that value (within the scope of the binding). But we can <em>shadow</em> a binding by introducing a second binding for a variable within the scope of the first binding. One might say that old bindings never die, they just fade away.</p>
<p><strong>Type environment records the types of variables. Value environment records their values.</strong></p>
<p><strong>local binding</strong>: </p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = u <span class="keyword">in</span> v</span><br></pre></td></tr></table></figure>
<p>The binding of <code>x</code> to the result of <code>u</code> is only visible within the expression <code>v</code>. The semantics is to evaluate <code>u</code> first and bind to variable <code>x</code>, finally evaluate <code>v</code> with this bounded variable <code>x</code>.</p>
<p>Notes: local binding shadowing only happens during that binding period, for example:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> y = <span class="keyword">let</span> x = <span class="number">2</span> <span class="keyword">in</span> x</span><br><span class="line"><span class="keyword">let</span> z = x + <span class="number">2</span></span><br><span class="line"><span class="comment">(* z will be binded to 3, not 4 because the global binding of x becomes visible again *)</span></span><br></pre></td></tr></table></figure>
<h2 id="Primitive-Data-Types"><a href="#Primitive-Data-Types" class="headerlink" title="Primitive Data Types"></a>Primitive Data Types</h2><ul>
<li>int (31-bit sign int on 32-bit processors or 63-bit sign int on 64-bit processors)</li>
<li><p>float (IEEE double-precision floating point)</p>
</li>
<li><p>booleans</p>
</li>
</ul>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># (<span class="number">1</span> &lt; <span class="number">2</span>) = <span class="literal">false</span>;;</span><br><span class="line">- : <span class="built_in">bool</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"># <span class="keyword">let</span> one = <span class="keyword">if</span> <span class="literal">true</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">2</span>;;</span><br><span class="line"><span class="keyword">val</span> one : <span class="built_in">int</span> = <span class="number">1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>characters (8-bit)</li>
</ul>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># <span class="string">'a'</span>;;</span><br><span class="line">- : <span class="built_in">char</span> = <span class="string">'a'</span></span><br><span class="line"></span><br><span class="line"># int_of_char <span class="string">'\n'</span></span><br><span class="line">- : <span class="built_in">int</span> = <span class="number">10</span></span><br></pre></td></tr></table></figure>
<ul>
<li>unit ()</li>
</ul>
<p>Unit type is useful in signaling the completion of some program. Ex:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">match</span> print_endline <span class="string">"first string"</span> <span class="keyword">with</span></span><br><span class="line">| <span class="literal">()</span> -&gt; print_endline <span class="string">"second string"</span></span><br></pre></td></tr></table></figure>
<ul>
<li>immutable character strings</li>
</ul>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># <span class="string">"Hello"</span> ^ <span class="string">" "</span> ^ <span class="string">"world"</span>;;</span><br><span class="line">- : <span class="built_in">string</span> = <span class="string">"Hello world"</span></span><br></pre></td></tr></table></figure>
<h2 id="Compound-Data-Types"><a href="#Compound-Data-Types" class="headerlink" title="Compound Data Types:"></a>Compound Data Types:</h2><ul>
<li>Tuples</li>
</ul>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">let</span> a_tuple : <span class="built_in">int</span> * <span class="built_in">string</span> = (<span class="number">3</span>, <span class="string">"three"</span>);;</span><br></pre></td></tr></table></figure>
<p>A tuple is an ordered collection of values that can each be of a different type.</p>
<ul>
<li>Lists</li>
</ul>
<p>Actually </p>
<p>List is a build-in variants:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="symbol">'a</span> <span class="built_in">list</span> = <span class="literal">[]</span> | (::) <span class="keyword">of</span> <span class="symbol">'a</span> * <span class="symbol">'a</span> <span class="built_in">list</span></span><br></pre></td></tr></table></figure>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">let</span> l = [<span class="string">"is"</span>; <span class="string">"a"</span>; <span class="string">"tale"</span>; <span class="string">"told"</span>; <span class="string">"etc."</span>];;</span><br><span class="line"><span class="keyword">val</span> l : <span class="built_in">string</span> <span class="built_in">list</span> = [<span class="string">"is"</span>; <span class="string">"a"</span>; <span class="string">"tale"</span>; <span class="string">"told"</span>; <span class="string">"etc."</span>]</span><br><span class="line"></span><br><span class="line"># <span class="string">"Life"</span> :: l;;</span><br><span class="line">- : <span class="built_in">string</span> <span class="built_in">list</span> = [<span class="string">"Life"</span>; <span class="string">"is"</span>; <span class="string">"a"</span>; <span class="string">"tale"</span>; <span class="string">"told"</span>; <span class="string">"etc."</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># [<span class="number">1</span>; <span class="number">2</span>; <span class="number">3</span>];;</span><br><span class="line"># <span class="number">1</span> :: (<span class="number">2</span> :: (<span class="number">3</span> :: <span class="literal">[]</span>));;</span><br><span class="line"># <span class="number">1</span> :: <span class="number">2</span> :: <span class="number">3</span> :: <span class="literal">[]</span>;;</span><br></pre></td></tr></table></figure>
<p>The bracket notation is a syntax sugar for <code>::</code>. <code>::</code> is right-associative.</p>
<p><code>@</code> can be used to concatenate two lists. (not a constant-time operation)</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># [<span class="number">1</span>; <span class="number">2</span>; <span class="number">3</span>] @ [<span class="number">4</span>; <span class="number">5</span>; <span class="number">6</span>];;</span><br></pre></td></tr></table></figure>
<ul>
<li>Options</li>
</ul>
<p>This is also a built-in variants:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="symbol">'a</span> option = <span class="type">None</span> | <span class="type">Some</span> <span class="keyword">of</span> <span class="symbol">'a</span></span><br></pre></td></tr></table></figure>
<p>An option is used to express that a value might or might not be present.</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">let</span> divide x y =</span><br><span class="line">	<span class="keyword">if</span> y = <span class="number">0</span> <span class="keyword">then</span> <span class="type">None</span> <span class="keyword">else</span> <span class="type">Some</span> (x/y) ;;</span><br></pre></td></tr></table></figure>
<p>Keywords <code>Some</code> and <code>None</code> are construtors that let us build optional values. To examine the contents of an option, we use pattern matching.</p>
<p>The <code>None</code> type is useful in many situations, for example, when allocating memory, if the allocation fails, return <code>None</code> value is usually a good choice.</p>
<ul>
<li>Records</li>
</ul>
<p>We can also define our own data type.</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">type</span> point2d = &#123; x : <span class="built_in">float</span>; y : <span class="built_in">float</span>&#125;;;</span><br></pre></td></tr></table></figure>
<p>Dot notation for accessing record fields:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> magnitude &#123; x; y&#125; = sqrt (x ** <span class="number">2.</span> +. y ** <span class="number">2.</span>);;</span><br><span class="line"># <span class="keyword">let</span> distance v1 v2 =</span><br><span class="line">	magnitude &#123; x = v1.x -. v2.x; y = v1.y -. v2.y&#125;;;</span><br></pre></td></tr></table></figure>
<h2 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h2><p>OCaml use <em>typer inference</em> to work out the types.</p>
<p>OCaml doesn’t do any implicit casting nor do any automatic conversion.</p>
<p>A function which takes input of type <code>a</code> and can often give an output of type <code>b</code> may declare itself as type <code>a -&gt; b option</code>, indicating that it may give a <code>None</code> value for some reason.</p>
<h3 id="Function-Expression"><a href="#Function-Expression" class="headerlink" title="Function Expression"></a>Function Expression</h3><p>Function is an expression which can be evaluated.</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">(* syntax for a function expression*)</span></span><br><span class="line"><span class="keyword">fun</span> n -&gt; n + <span class="number">1</span>;;</span><br><span class="line"></span><br><span class="line"><span class="comment">(* applying a function to a value *)</span></span><br><span class="line">(<span class="keyword">fun</span> n -&gt; n + <span class="number">1</span>) <span class="number">2</span>;;</span><br></pre></td></tr></table></figure>
<h3 id="Function-type"><a href="#Function-type" class="headerlink" title="Function type"></a>Function type</h3><p>Each function has a type, which can be writen as:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a -&gt; b</span><br></pre></td></tr></table></figure>
<p>Where <code>a</code> is its domain, and <code>b</code> is its codoman.</p>
<p>The arrow operation is right-associative, so the following two type specifications are the same:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> -&gt; (<span class="built_in">int</span> -&gt; (<span class="built_in">bool</span> -&gt; <span class="built_in">int</span>))</span><br><span class="line"><span class="built_in">int</span> -&gt; <span class="built_in">int</span> -&gt; <span class="built_in">bool</span> -&gt; <span class="built_in">int</span></span><br></pre></td></tr></table></figure>
<h3 id="Annotations"><a href="#Annotations" class="headerlink" title="Annotations"></a>Annotations</h3><p>There may be some ambiguity for function annotation, for example:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fun</span> x : <span class="built_in">int</span> -&gt; exp</span><br></pre></td></tr></table></figure>
<p>actually means</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fun</span> x -&gt; (exp : <span class="built_in">int</span>)</span><br></pre></td></tr></table></figure>
<p>To annotate the parameter, we have to include a parathesis:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fun</span> (x : <span class="built_in">int</span>) -&gt; exp</span><br></pre></td></tr></table></figure>
<h3 id="Function-with-Multiple-Parameters"><a href="#Function-with-Multiple-Parameters" class="headerlink" title="Function with Multiple Parameters"></a>Function with Multiple Parameters</h3><figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">(* syntax, the parameter type and expression type is auto-checked by type checking mechanism*)</span></span><br><span class="line"><span class="keyword">fun</span> x y -&gt; x +. y;;</span><br><span class="line"></span><br><span class="line"><span class="comment">(* apply to 2 arguments *)</span></span><br><span class="line">(<span class="keyword">fun</span> x y -&gt; x +. y) <span class="number">3.</span> <span class="number">4.</span> ;;</span><br></pre></td></tr></table></figure>
<h3 id="Bind-Function-to-Variable"><a href="#Bind-Function-to-Variable" class="headerlink" title="Bind Function to Variable"></a>Bind Function to Variable</h3><figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> f = <span class="keyword">fun</span> n -&gt; n + <span class="number">1</span>;;</span><br><span class="line">f <span class="number">2</span>;;</span><br></pre></td></tr></table></figure>
<h3 id="Define-Named-Function-another-syntax"><a href="#Define-Named-Function-another-syntax" class="headerlink" title="Define Named Function (another syntax)"></a>Define Named Function (another syntax)</h3><ul>
<li><code>let f = fun p1 p2 ... -&gt; expr</code></li>
<li><code>let f p1 p2 ... = expr</code></li>
</ul>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> f x = x + <span class="number">1</span>;;</span><br><span class="line">f <span class="number">3</span>;;</span><br><span class="line"><span class="keyword">let</span> f x y = x + y;;</span><br><span class="line">f <span class="number">3</span> <span class="number">4</span>;;</span><br></pre></td></tr></table></figure>
<h2 id="Polymorphism"><a href="#Polymorphism" class="headerlink" title="Polymorphism"></a>Polymorphism</h2><figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> id : <span class="symbol">'a</span> . <span class="symbol">'a</span> -&gt; <span class="symbol">'a</span></span><br><span class="line">  = <span class="keyword">fun</span> x -&gt; x</span><br></pre></td></tr></table></figure>
<p>By type annotating the function in this way, we are saying that <code>id</code> function is of type <code>a -&gt; a</code> for any type <code>a</code>. For example, <code>id</code> can be of the types <code>int -&gt; int</code>, <code>bool -&gt; bool</code> or <code>string -&gt; string</code>. The type checking will all pass by annotating in this way.</p>
<h3 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h3><figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">'a1</span> <span class="symbol">'a2</span> <span class="symbol">'a3</span> ... <span class="symbol">'an</span> . <span class="keyword">type</span></span><br></pre></td></tr></table></figure>
<p>The type variables before the dot <code>.</code> Are like universal quantifiers, forcing OCaml to check the generality of the value.</p>
<h1 id="Part-2-Induction"><a href="#Part-2-Induction" class="headerlink" title="Part 2: Induction"></a>Part 2: Induction</h1><p><strong>Non-effect assumption: we can change the evaluation order and assume every expression will terminate.</strong></p>
<p>Mathematical induction has two important components:</p>
<ol>
<li>Case analysis.</li>
<li>The ability to assume that the theorem we want to prove holds for “smaller” objects.</li>
</ol>
<p>General form of induction works on any mathematical objects with <strong>well-founded</strong> relation (no infinite descending chains). The order chosen for induction is called induction order.</p>
<p>The proof following the general form of induction involves:</p>
<ul>
<li>We want to prove some property <code>P(x)</code> about some collection of mathematical objects <code>x</code>.</li>
<li>We choose a good order <code>R</code> as the induction order. (For the mathematical induction, <code>R(x,y)</code> if and only if <code>x + 1 = y</code>.)</li>
<li>We prove that, for any <code>x</code>, if <code>P(x&#39;)</code> holds for any <code>x&#39;</code> such that <code>R(x&#39;, x)</code>, then <code>P(x)</code> holds.</li>
<li>We conclude that the property <code>P(x)</code> holds for every such mathematical object <code>x</code>.</li>
</ul>
<p>Examples of <strong>well-founded</strong> relation: “subtree” relation for binary trees, “sublist” relation for finite lists.</p>
<p>For example, for <code>a list</code>, we define the relation as <code>R(l1, l2)</code> if and only if <code>l1</code> is a proper suffix of <code>l2</code>. The partition for lists can be either empty list <code>[]</code> with no suffix, or <code>hd :: tl</code>. Then, we perform the following steps:</p>
<ul>
<li>We want to prove some property <code>P(l)</code> about values <code>l</code> of type <code>a list</code>.</li>
<li>We show that <code>P([])</code> holds. (There is no proper suffix).</li>
<li>We show that for non-empty list <code>l</code> of form <code>hd :: tl</code>, if <code>P(l&#39;)</code> holds for all proper suffixes, then <code>P(l)</code> is true.</li>
<li>We conclude that the property <code>P(l)</code> holds for any list <code>l</code>.</li>
</ul>
<p>Suggestions for deciding ordering and the partition: follow the pattern matching and recursive calls.</p>
<p><a href="https://github.umn.edu/umn-csci-2041-f19/notes" target="_blank" rel="noopener">Some induction proof</a> (Reference from Favonia)</p>
<h1 id="Part-3-Effects"><a href="#Part-3-Effects" class="headerlink" title="Part 3: Effects"></a>Part 3: Effects</h1><p>Every OCaml expression either</p>
<ul>
<li>evaluates to a value</li>
<li>raises an exception</li>
<li>or fails to terminate (“infinite loop”)</li>
</ul>
<h2 id="Exceptions"><a href="#Exceptions" class="headerlink" title="Exceptions"></a>Exceptions</h2><p>OCaml’s exception mechanism is similar to many other programming languages.</p>
<p>Syntax of defining a new type of OCaml exception:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">exception</span> <span class="type">E</span> <span class="keyword">of</span> t</span><br></pre></td></tr></table></figure>
<p><code>E</code> is a constructor name and <code>t</code> is a type. The <code>of t</code> part is optional, similar to <code>type variants</code>.</p>
<p>Create an <code>exception</code> value:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Failure</span> <span class="string">"something went wrong"</span></span><br></pre></td></tr></table></figure>
<p>Raise and exception value <code>e</code>:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">raise e</span><br></pre></td></tr></table></figure>
<p>Catch an exception, use:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> e <span class="keyword">with</span></span><br><span class="line">| p1 -&gt; e1</span><br><span class="line">| ...</span><br><span class="line">| pn -&gt; en</span><br></pre></td></tr></table></figure>
<p>The expression <code>e</code> may raise an exception. If it does not, the entire expression evaluate to what <code>e</code> does. If <code>e</code> does raise an exception value <code>v</code>, <code>v</code> is matched against the provided patterns, like pattern matching.</p>
<p>All exception values have type <code>exn</code>.</p>
<h3 id="Common-Usage-of-Exceptions"><a href="#Common-Usage-of-Exceptions" class="headerlink" title="Common Usage of Exceptions"></a>Common Usage of Exceptions</h3><ol>
<li>Indicators of an error.</li>
<li>Placeholders for unfinished code.</li>
<li>Out-of-band communication.</li>
</ol>
<h2 id="Sequencing-of-Effects"><a href="#Sequencing-of-Effects" class="headerlink" title="Sequencing of Effects"></a>Sequencing of Effects</h2><p>We can use semicolon operator to sequence effects.</p>
<ul>
<li>Syntax: <code>e1; e2</code></li>
<li>Dynamic semantics:(动态语义涉及程序运行顺序以及结果) To evaluate <code>e1; e2</code>,<ul>
<li>First evaluate <code>e1</code> to a value <code>v1</code>.</li>
<li>Then evaluate <code>e2</code> to a value <code>v2</code>.</li>
<li>Return <code>v2</code>. (Discard <code>v1</code>)</li>
</ul>
</li>
<li>Static semantics: (静态语义涉及表达式类型) <code>e1; e2 : t</code> if <code>e1 : unit</code> and <code>e2 : t</code>.</li>
</ul>
<p>Note that all expressions except for the last one should have type <code>unit</code>, otherwise OCaml will raise a warning.</p>
<h1 id="Part-4-Modules"><a href="#Part-4-Modules" class="headerlink" title="Part 4: Modules"></a>Part 4: Modules</h1><h2 id="Modular-Programming"><a href="#Modular-Programming" class="headerlink" title="Modular Programming"></a>Modular Programming</h2><p>One key solution to managing complexity of large software is <em>modular programming</em>. The key idea of modular programming is “local reasoning”, for which the reasoning is only about just the module. The solution to local reasoning is abstraction (module specification), for which we only need to design the functionality of each components without considering how it is implemented.</p>
<h3 id="Module-Systems"><a href="#Module-Systems" class="headerlink" title="Module Systems"></a>Module Systems</h3><ul>
<li>Namespaces: a set of names are grouped together. In OCaml, we can use <em>structures</em> to group names.</li>
<li>Abstraction: hides information, enables encapsulation, information hiding. In OCaml, we use <em>signature</em> to abstract structures by hiding some of the structure’s names.</li>
<li>Code reuse: enables code from one module to be used as part of another module without having to copy. In OCaml, we can use <em>functirs</em> and <em>includes</em> to reuse code.</li>
</ul>
<h3 id="OCaml-Modules"><a href="#OCaml-Modules" class="headerlink" title="OCaml Modules"></a>OCaml Modules</h3><p>The OCaml module system is based on <em>structures</em> and <em>signatures</em>. In which <em>structures</em> are the core and <em>signatures</em> are the types of structures.</p>
<h4 id="Structures"><a href="#Structures" class="headerlink" title="Structures"></a>Structures</h4><p>syntax:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="type">ModuleName</span> = <span class="type">Struct</span></span><br><span class="line">	<span class="comment">(* definition *)</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>structure:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="comment">(* definitions *)</span> <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>A structure is a sequence of definitions, the structure itself is anonymous (has no name).</p>
<p>Modules partition the namespace, any symbol <code>x</code> in side the module must be accessed with the module name <code>ModuleName.x</code> outside the module. (or use <code>open</code> to make the namespace public)</p>
<p>The implementation of a module can contain <code>type</code>, <code>exception</code>, <code>let</code>, <code>open</code> and some others.</p>
<h4 id="Scope"><a href="#Scope" class="headerlink" title="Scope"></a>Scope</h4><p>After a module <code>M</code> has been defined, we can access the names by using the <code>.</code> operator. For example: <code>M.x</code>.</p>
<p>We can also make the namepace public by using key word <code>open</code>: <code>open M</code>.</p>
<p>Semantics meaning of <code>open String</code>:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> length = <span class="type">String</span>.length</span><br><span class="line"><span class="keyword">let</span> get = <span class="type">String</span>.get</span><br><span class="line"><span class="keyword">let</span> lowercase_ascii = <span class="type">String</span>.lowercase_ascii</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>The module <em>Stdlib</em> is automatically opened in every OCaml program.</p>
<p>The shadowing mechanism also fits for module opening:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="type">M</span> = <span class="keyword">struct</span> <span class="keyword">let</span> x = <span class="number">42</span> <span class="keyword">end</span></span><br><span class="line"><span class="keyword">module</span> <span class="type">N</span> = <span class="keyword">struct</span> <span class="keyword">let</span> x = <span class="string">"bigred"</span> <span class="keyword">end</span></span><br><span class="line"><span class="keyword">open</span> <span class="type">M</span></span><br><span class="line">oepn <span class="type">N</span></span><br><span class="line"><span class="comment">(* The name defined later shadows the name defined before. *)</span></span><br></pre></td></tr></table></figure>
<p>If we have multiple modules, it’s generally good practice not to <code>open</code> all the modules at the top of the program.</p>
<p>One fatanstic solution to avoid collision is “local opening”:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">(* without [open] *)</span></span><br><span class="line"><span class="keyword">let</span> f x =</span><br><span class="line">	<span class="keyword">let</span> y = <span class="type">List</span>.filter ((&gt;) <span class="number">0</span>) x <span class="keyword">in</span></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line"><span class="comment">(* with [open] *)</span></span><br><span class="line"><span class="keyword">let</span> f x =</span><br><span class="line">	<span class="keyword">let</span> <span class="keyword">open</span> <span class="type">List</span> <span class="keyword">in</span></span><br><span class="line">	<span class="keyword">let</span> y =filter ((&gt;) <span class="number">0</span>) x <span class="keyword">in</span></span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<h4 id="Signatures"><a href="#Signatures" class="headerlink" title="Signatures"></a>Signatures</h4><p>We can use module type to describe the modules. One solution to defining module types is <em>signatures</em>.</p>
<p>Syntax:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="keyword">type</span> <span class="type">ModuleTypeName</span> = <span class="keyword">sig</span></span><br><span class="line">	<span class="comment">(* declarations *)</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Stack signature:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">module type Stack = sig</span><br><span class="line">	type &apos;a stack</span><br><span class="line">	val empty : &apos;a stack</span><br><span class="line">	val is_empty : &apos;a stack -&gt; bool</span><br><span class="line">	val push : &apos;a -&gt; &apos;a stack -&gt; &apos;a stack</span><br><span class="line">	val peek : &apos;a stack -&gt; &apos;a</span><br><span class="line">	val pop : &apos;a stack -&gt; &apos;a stack</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>By convention, the module type name is also capitalized.</p>
<p><code>val id : t</code> means there is a value named <code>id</code> whose type is <code>t</code>.</p>
<p>A structure matches a signature if the structure provides definitions for all the names specified in the signature and the types are also matched. (Allowing polymorphism)</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="keyword">type</span> <span class="type">Sig</span> = <span class="keyword">sig</span></span><br><span class="line">	<span class="keyword">val</span> f : <span class="built_in">int</span> -&gt; <span class="built_in">int</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> <span class="type">M1</span> : <span class="type">Sig</span> = <span class="keyword">struct</span></span><br><span class="line">	<span class="keyword">let</span> f x = x+<span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> <span class="type">M2</span> : <span class="type">Sig</span> = <span class="keyword">struct</span></span><br><span class="line">	<span class="keyword">let</span> f x = x</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Module <code>M1</code> provides a function <code>f</code> of type <code>int -&gt; int</code>. Module <code>M2</code> provides a function of type <code>&#39;a -&gt; &#39;a</code>. Both <code>M1</code> and <code>M2</code> match <code>Sig</code>.</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="type">ListStack</span> : <span class="type">Stack</span> = <span class="keyword">struct</span></span><br><span class="line">	<span class="keyword">type</span> <span class="symbol">'a</span> stack = <span class="symbol">'a</span> <span class="built_in">list</span></span><br><span class="line">	<span class="comment">(* rest *)</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h4 id="Abstract-Types"><a href="#Abstract-Types" class="headerlink" title="Abstract Types"></a>Abstract Types</h4><p>The type <code>&#39;a stack</code> above is abstract. The <code>Stack</code> module type says that there is a type name <code>&#39;a stack</code> in any module that implements the module type.</p>
<p>A module that implements a module type must specify concrete types for the abstract types in the signature and define all the names declared in the signature.</p>
<p>Only declarations in the signature are accessible outside of the module. (encapsulation)</p>
<p>An OCaml convention to short name the declaration:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="keyword">type</span> <span class="type">Stack</span> = <span class="keyword">sig</span></span><br><span class="line">	<span class="keyword">type</span> <span class="symbol">'a</span> t</span><br><span class="line">	<span class="keyword">val</span> empty : <span class="symbol">'a</span> t</span><br><span class="line">	<span class="keyword">val</span> is_empty : <span class="symbol">'a</span> t -&gt; <span class="built_in">bool</span></span><br><span class="line">	<span class="keyword">val</span> push : <span class="symbol">'a</span> -&gt; <span class="symbol">'a</span> t -&gt; <span class="symbol">'a</span> t</span><br><span class="line">	<span class="keyword">val</span> peek : <span class="symbol">'a</span> t -&gt; <span class="symbol">'a</span></span><br><span class="line">	<span class="keyword">val</span> pop : <span class="symbol">'a</span> t -&gt; <span class="symbol">'a</span> t</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Custom Printers:</p>
<p><a href="https://www.cs.cornell.edu/courses/cs3110/2019fa/textbook/modules/abstract_types.html" target="_blank" rel="noopener">https://www.cs.cornell.edu/courses/cs3110/2019fa/textbook/modules/abstract_types.html</a></p>
<h4 id="Semantics"><a href="#Semantics" class="headerlink" title="Semantics"></a>Semantics</h4><p>Semantics of the OCaml module system</p>
<ul>
<li>Dynamic semantics: To evaluate a structure <code>structure D1; ...; Dn end</code> where each of the <code>Di</code> is a definition, evaluate each definition in order.</li>
<li>Static semantics: For <code>module M : T = struct ... end</code>. There are two checks the compiler must perform:<ul>
<li>Signature matching: every name declared in <code>T</code> must be defined in <code>M</code>.</li>
<li>Encapsulation: any name defined in <code>M</code> that does not appear in <code>T</code> is not visible to code outside of <code>M</code>.</li>
</ul>
</li>
</ul>
<h4 id="Functional-Data-Structures"><a href="#Functional-Data-Structures" class="headerlink" title="Functional Data Structures"></a>Functional Data Structures</h4><p>Functional data structures have the property of being persistent: updating the data structure with one of its operations does not change the existing version of the data structure but instead produces a new version. Both exist and both can be accessed. The opposite of a persistent data structure is an ephemeral data structure: changes are destructive so that only one version exists at any time. Both persistent and ephemeral data structures can be built in both functional and imperative languages.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># open ListStack;;</span><br><span class="line"># let s = push 1 (push 2 empty);;</span><br><span class="line">val s : int list = [1; 2]</span><br><span class="line"># let s&apos; = pop s;;</span><br><span class="line">val s&apos; : int list = [2]</span><br><span class="line"># s;;</span><br><span class="line">- : int list = [1; 2]</span><br></pre></td></tr></table></figure>
<p>The value <code>s</code> is unchanged by the <code>pop</code> operation; both version of the stack coexist.</p>
<h4 id="Examples-Stack"><a href="#Examples-Stack" class="headerlink" title="Examples: Stack"></a>Examples: Stack</h4><h4 id="Examples-Queues"><a href="#Examples-Queues" class="headerlink" title="Examples: Queues"></a>Examples: Queues</h4><h4 id="Examples-Dictionaries"><a href="#Examples-Dictionaries" class="headerlink" title="Examples: Dictionaries"></a>Examples: Dictionaries</h4><h4 id="Examples-Sets"><a href="#Examples-Sets" class="headerlink" title="Examples: Sets"></a>Examples: Sets</h4><h4 id="Examples-Arithmetic"><a href="#Examples-Arithmetic" class="headerlink" title="Examples: Arithmetic"></a>Examples: Arithmetic</h4><h3 id="Sharing-Constraints"><a href="#Sharing-Constraints" class="headerlink" title="Sharing Constraints"></a>Sharing Constraints</h3><p>Syntax</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="type">Ints</span> : (<span class="type">Arith</span> <span class="keyword">with</span> <span class="keyword">type</span> t = <span class="built_in">int</span>) = <span class="keyword">struct</span></span><br><span class="line">	<span class="comment">(* all of Ints as before *)</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>We can write sharing constraints that refine a signature by specifying equations that must hold on the abstract types in that signature. E.g. If <code>T</code> is a module type containing an abstract type <code>t</code>, then <code>T with type t = int</code> is a new module type that is the same <code>T</code>, except that <code>t</code> is known to be <code>int</code>. </p>
<h3 id="Compilation-Units"><a href="#Compilation-Units" class="headerlink" title="Compilation Units"></a>Compilation Units</h3><p>A compilation unit is a pair of OCaml source files in the same directory. They share the same prefix but their extension differ: one file is <code>x.ml</code>, the other is <code>x.mli</code>. The file <code>x.ml</code> is called the implementation, and <code>x.mli</code> is called the interface. Similar to <code>x.c</code> and <code>x.h</code>.</p>
<p>E.g:</p>
<p><code>foo.mli</code></p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> x : <span class="built_in">int</span></span><br><span class="line"><span class="keyword">val</span> f : <span class="built_in">int</span> -&gt; <span class="built_in">int</span> -&gt; <span class="built_in">int</span></span><br></pre></td></tr></table></figure>
<p><code>foo.ml</code></p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="type">Foo</span> : <span class="keyword">sig</span></span><br><span class="line">	<span class="keyword">val</span> x : <span class="built_in">int</span></span><br><span class="line">	<span class="keyword">val</span> f : <span class="built_in">int</span> -&gt; <span class="built_in">int</span> -&gt; <span class="built_in">int</span></span><br><span class="line"><span class="keyword">end</span> = <span class="keyword">struct</span></span><br><span class="line">	<span class="keyword">let</span> x = <span class="number">0</span></span><br><span class="line">	<span class="keyword">let</span> y = <span class="number">12</span></span><br><span class="line">	<span class="keyword">let</span> f x y = x + y</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>In general, when the compiler encounters a compilation unit, it treats them as defining a module and a signature like this:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="type">Foo</span> : <span class="keyword">sig</span> <span class="comment">(* insert contents of foo.mli here *)</span> <span class="keyword">end</span></span><br><span class="line">	<span class="comment">(* insert contents of foo.ml here *)</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>The unit name <code>Foo</code> is derived from the base name <code>foo</code> by just capitalizing the first letter. No named module type is defined, the signature of <code>Foo</code> is anonymous.</p>
<h3 id="Comments"><a href="#Comments" class="headerlink" title="Comments"></a>Comments</h3><p>The comments that go in an interface file vs. an implementation file are different. </p>
<p>Interface files will be read by clients of an abstraction. These will generally be specification comments describing how to use the abstraction, the preconditions and what exceptions they might raise, even time complexity and space complexity.</p>
<p>Implementation files will be read by programmers and maintainers of an abstraction, so the comments that go there are for them. These will generally be specification about how the representation type is used, how the code works.</p>
<h3 id="Code-Reuse"><a href="#Code-Reuse" class="headerlink" title="Code Reuse"></a>Code Reuse</h3><h4 id="Includes"><a href="#Includes" class="headerlink" title="Includes"></a>Includes</h4><p>OCaml provides a language features called included that enables code reuse, similar to the object-oriented language. It enables a structure to include all the values defined by another structure, or a signature to include all the names declared by another signature.</p>
<p>E.g:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="type">ListSetDupsExtented</span> = <span class="keyword">struct</span></span><br><span class="line">	<span class="keyword">include</span> <span class="type">ListSetDups</span></span><br><span class="line">	<span class="keyword">let</span> of_list lst = <span class="type">List</span>.fold_right add lst empty</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>We can also provide a new implementation of one of includedd functions:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="type">ListSetDupsExtended</span> = <span class="keyword">struct</span></span><br><span class="line">	<span class="keyword">include</span> <span class="type">ListSetDups</span></span><br><span class="line">	<span class="keyword">let</span> of_list lst = <span class="type">List</span>.fold_right add lst empty</span><br><span class="line">	<span class="keyword">let</span> <span class="keyword">rec</span> elts = <span class="keyword">function</span></span><br><span class="line">	| <span class="literal">[]</span> -&gt; <span class="literal">[]</span></span><br><span class="line">	| h::t -&gt; <span class="keyword">if</span> mem h t <span class="keyword">then</span> elts' t <span class="keyword">else</span> h::(elts' t)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>The new implementation doesn’t replace the old one. Since the module evaluation is from top to bottom.</p>
<p>Include vs. Open:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="type">M</span> = <span class="keyword">struct</span></span><br><span class="line">	<span class="keyword">let</span> x = <span class="number">0</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> <span class="type">N</span> = <span class="keyword">struct</span></span><br><span class="line">	<span class="keyword">include</span> <span class="type">M</span></span><br><span class="line">	<span class="keyword">let</span> y = x + <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> <span class="type">O</span> = <span class="keyword">struct</span></span><br><span class="line">	<span class="keyword">open</span> <span class="type">M</span></span><br><span class="line">	<span class="keyword">let</span> y = x + <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Dynamic semantics:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="type">M</span> : <span class="keyword">sig</span> <span class="keyword">val</span> x : <span class="built_in">int</span> <span class="keyword">end</span></span><br><span class="line"><span class="keyword">module</span> <span class="type">N</span> : <span class="keyword">sig</span> <span class="keyword">val</span> x : <span class="built_in">int</span> <span class="keyword">val</span> y : <span class="built_in">int</span> <span class="keyword">end</span></span><br><span class="line"><span class="keyword">module</span> <span class="type">O</span> : <span class="keyword">sig</span> <span class="keyword">val</span> y : <span class="built_in">int</span> <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p><code>Include</code> causes all the definitions to also be included. But <code>open</code> only makes those definitions available in the scope, it doesn’t make them part of the structure.</p>
<h4 id="Functors"><a href="#Functors" class="headerlink" title="Functors"></a>Functors</h4><p>A functor is simply a function from structures to structures.</p>
<p>E.g:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="keyword">type</span> <span class="type">X</span> = <span class="keyword">sig</span></span><br><span class="line">	<span class="keyword">val</span> x : <span class="built_in">int</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="type">IncX</span> (<span class="type">M</span> : <span class="type">X</span>) = <span class="keyword">struct</span></span><br><span class="line">	<span class="keyword">let</span> x = <span class="type">M</span>.x + <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Apply functors:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="type">A</span> = <span class="keyword">struct</span> <span class="keyword">let</span> x = <span class="number">0</span> <span class="keyword">end</span></span><br><span class="line"><span class="keyword">module</span> <span class="type">B</span> = <span class="type">IncX</span>(<span class="type">A</span>)</span><br><span class="line"><span class="keyword">module</span> <span class="type">C</span> = <span class="type">IncX</span>(<span class="type">B</span>)</span><br></pre></td></tr></table></figure>
<p>Syntax:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="type">F</span> (<span class="type">M</span> : <span class="type">S</span>) = <span class="keyword">struct</span></span><br><span class="line">	...</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* anonymous functor *)</span></span><br><span class="line"><span class="keyword">module</span> <span class="type">F</span> = <span class="keyword">functor</span> (<span class="type">M</span> : <span class="type">S</span>) -&gt; <span class="keyword">struct</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> <span class="type">F</span> (<span class="type">M1</span> : <span class="type">S1</span>) ... (<span class="type">Mn</span> : <span class="type">Sn</span>) = <span class="keyword">struct</span></span><br><span class="line">	...</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* anonymous functor *)</span></span><br><span class="line"><span class="keyword">module</span> <span class="type">F</span> = <span class="keyword">functor</span> (<span class="type">M1</span> : <span class="type">S1</span>) -&gt; ... -&gt; <span class="keyword">functor</span> (<span class="type">Mn</span> : <span class="type">Sn</span>) -&gt; <span class="keyword">struct</span></span><br><span class="line">	...</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* output type as a functor *)</span></span><br><span class="line"><span class="keyword">module</span> <span class="type">F</span> (<span class="type">M</span> : <span class="type">Si</span>) : <span class="type">So</span> = <span class="keyword">struct</span></span><br><span class="line">	...</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">(* alternate form *)</span></span><br><span class="line"><span class="keyword">module</span> <span class="type">F</span> (<span class="type">M</span> : <span class="type">Si</span>) = (<span class="keyword">struct</span></span><br><span class="line">	...</span><br><span class="line"><span class="keyword">end</span> : <span class="type">So</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">(* functor type annotation *)</span></span><br><span class="line"><span class="keyword">functor</span> (<span class="type">M</span> : <span class="type">Si</span>) -&gt; <span class="type">So</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> <span class="type">F</span> : <span class="keyword">functor</span> (<span class="type">M</span> : <span class="type">Si</span>) -&gt; <span class="type">So</span> =</span><br><span class="line">	<span class="keyword">functor</span> (<span class="type">M</span> : <span class="type">Si</span>) -&gt; <span class="keyword">struct</span> ... <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p><strong>One thing to note:</strong> The output of the functor can depend on the input module. This can not happend on the expression level!</p>
<p>Eg:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">functor</span> (<span class="type">M</span> : <span class="type">ORDERED_TYPE</span>) -&gt; <span class="type">EXTENDED_ORDERED_TYPE</span> <span class="keyword">with</span> <span class="keyword">type</span> t = <span class="type">M</span>.t <span class="comment">(* signature annotation explicitly *)</span></span><br></pre></td></tr></table></figure>
<p>The OCaml compiler won’t complain about the signature annotation without constraints, but this is fatal since we have to make sure <code>type t</code> is the same type as module <code>M</code> (we have to make the invoking function call work in this case, otherwise there might be runtime error).</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>Last time we talked about that OCaml binding is permanent which means “immutability”. But OCaml also supports “mutability” with the “reference” language feature.</p>
<h3 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h3><p> A <em>ref</em> is like a pointer or reference in an imperative language. It is a location in memory whose contents may change. Refs are also called ref cells.</p>
<ul>
<li>Creates a reference:</li>
</ul>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="built_in">ref</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>By using the keyword <code>ref</code>. OCaml allocates and initializes a memory location for us and gives us the handle. <code>x</code> has type <code>int ref</code>. This is a new type constructor.</p>
<ul>
<li>Access the content:</li>
</ul>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!x</span><br></pre></td></tr></table></figure>
<p><code>!x</code> dereferences <code>x</code> and returns the contents of the memory location. <code>!</code> is the dereference operator.</p>
<ul>
<li>Assignment</li>
</ul>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x := <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p><code>:=</code> is the assign operator in OCaml, by using this operator, we are not changing the value <code>x</code> but are changing the content which it refers to. (Variable are immutable, memory is mutable but variable bindings are not)</p>
<h4 id="Dynamic-Semantics"><a href="#Dynamic-Semantics" class="headerlink" title="Dynamic Semantics:"></a>Dynamic Semantics:</h4><ul>
<li><code>ref e</code><ul>
<li>Evaluate <code>e</code> to a value <code>v</code></li>
<li>Allocate a new location <code>loc</code> in memory to hold <code>v</code></li>
<li>Store <code>v</code> in <code>loc</code></li>
<li>Return <code>loc</code></li>
</ul>
</li>
<li><code>e1 := e2</code><ul>
<li>Evaluate <code>e2</code> to a value <code>v</code>, and <code>e1</code> to a location <code>loc</code></li>
<li>Store <code>v</code> in <code>loc</code></li>
<li>Return <code>()</code>, i.e., unit</li>
</ul>
</li>
<li><code>!e</code><ul>
<li>Evaluate <code>e</code> to a location <code>loc</code></li>
<li>Return the contents of <code>loc</code></li>
</ul>
</li>
</ul>
<h4 id="Static-Semantics"><a href="#Static-Semantics" class="headerlink" title="Static Semantics"></a>Static Semantics</h4><ul>
<li><code>ref e : t ref</code> iff <code>e : t</code></li>
<li><code>e1 := e2 : unit</code> iff <code>e1 : t ref</code> and <code>e2 : t</code></li>
<li><code>!e : t</code> iff <code>e : t ref</code></li>
</ul>
<p>Done!</p>

      
    </div>

    

    
    
    

    <div>
    
    <div>

    <div style="text-align:center;color: #ccc;font-size:14px;">-------------End of the article <i class="fa fa-paw"></i> Thanks for reading!-------------</div>

</div>
    
    </div>

    

    
       
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Programming/" rel="tag"><i class="fa fa-tag"></i> Programming</a>
          
            <a href="/tags/Ocaml/" rel="tag"><i class="fa fa-tag"></i> Ocaml</a>
          
            <a href="/tags/Functional-Programming/" rel="tag"><i class="fa fa-tag"></i> Functional Programming</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/05/11/PyTorch Tutorial/" rel="next" title="PyTorch Tutorial">
                <i class="fa fa-chevron-left"></i> PyTorch Tutorial
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/09/25/ACM Algorithm Note/" rel="prev" title="ACM Algorithm Note">
                ACM Algorithm Note <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div id="gitalk-container"></div>  
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Qingliu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">21</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">2</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">21</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/Aden-Q" title="GitHub &rarr; https://github.com/Aden-Q" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:qian0102@umn.edu" title="E-Mail &rarr; mailto:qian0102@umn.edu" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://www.linkedin.com/in/azure-qian-11b128179" title="Linkedin &rarr; https://www.linkedin.com/in/azure-qian-11b128179" rel="noopener" target="_blank"><i class="fa fa-fw fa-linkedin"></i>Linkedin</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://www.facebook.com/zecheng.qian.7" title="FB Page &rarr; https://www.facebook.com/zecheng.qian.7" rel="noopener" target="_blank"><i class="fa fa-fw fa-facebook"></i>FB Page</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Part-1-Basics"><span class="nav-number">1.</span> <span class="nav-text">Part 1: Basics</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Binding"><span class="nav-number">1.1.</span> <span class="nav-text">Binding</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Primitive-Data-Types"><span class="nav-number">1.2.</span> <span class="nav-text">Primitive Data Types</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Compound-Data-Types"><span class="nav-number">1.3.</span> <span class="nav-text">Compound Data Types:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Function"><span class="nav-number">1.4.</span> <span class="nav-text">Function</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Function-Expression"><span class="nav-number">1.4.1.</span> <span class="nav-text">Function Expression</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Function-type"><span class="nav-number">1.4.2.</span> <span class="nav-text">Function type</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Annotations"><span class="nav-number">1.4.3.</span> <span class="nav-text">Annotations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Function-with-Multiple-Parameters"><span class="nav-number">1.4.4.</span> <span class="nav-text">Function with Multiple Parameters</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bind-Function-to-Variable"><span class="nav-number">1.4.5.</span> <span class="nav-text">Bind Function to Variable</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Define-Named-Function-another-syntax"><span class="nav-number">1.4.6.</span> <span class="nav-text">Define Named Function (another syntax)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Polymorphism"><span class="nav-number">1.5.</span> <span class="nav-text">Polymorphism</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Syntax"><span class="nav-number">1.5.1.</span> <span class="nav-text">Syntax</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Part-2-Induction"><span class="nav-number">2.</span> <span class="nav-text">Part 2: Induction</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Part-3-Effects"><span class="nav-number">3.</span> <span class="nav-text">Part 3: Effects</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Exceptions"><span class="nav-number">3.1.</span> <span class="nav-text">Exceptions</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Common-Usage-of-Exceptions"><span class="nav-number">3.1.1.</span> <span class="nav-text">Common Usage of Exceptions</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Sequencing-of-Effects"><span class="nav-number">3.2.</span> <span class="nav-text">Sequencing of Effects</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Part-4-Modules"><span class="nav-number">4.</span> <span class="nav-text">Part 4: Modules</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Modular-Programming"><span class="nav-number">4.1.</span> <span class="nav-text">Modular Programming</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Module-Systems"><span class="nav-number">4.1.1.</span> <span class="nav-text">Module Systems</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OCaml-Modules"><span class="nav-number">4.1.2.</span> <span class="nav-text">OCaml Modules</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Structures"><span class="nav-number">4.1.2.1.</span> <span class="nav-text">Structures</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Scope"><span class="nav-number">4.1.2.2.</span> <span class="nav-text">Scope</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Signatures"><span class="nav-number">4.1.2.3.</span> <span class="nav-text">Signatures</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Abstract-Types"><span class="nav-number">4.1.2.4.</span> <span class="nav-text">Abstract Types</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Semantics"><span class="nav-number">4.1.2.5.</span> <span class="nav-text">Semantics</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Functional-Data-Structures"><span class="nav-number">4.1.2.6.</span> <span class="nav-text">Functional Data Structures</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Examples-Stack"><span class="nav-number">4.1.2.7.</span> <span class="nav-text">Examples: Stack</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Examples-Queues"><span class="nav-number">4.1.2.8.</span> <span class="nav-text">Examples: Queues</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Examples-Dictionaries"><span class="nav-number">4.1.2.9.</span> <span class="nav-text">Examples: Dictionaries</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Examples-Sets"><span class="nav-number">4.1.2.10.</span> <span class="nav-text">Examples: Sets</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Examples-Arithmetic"><span class="nav-number">4.1.2.11.</span> <span class="nav-text">Examples: Arithmetic</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sharing-Constraints"><span class="nav-number">4.1.3.</span> <span class="nav-text">Sharing Constraints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Compilation-Units"><span class="nav-number">4.1.4.</span> <span class="nav-text">Compilation Units</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Comments"><span class="nav-number">4.1.5.</span> <span class="nav-text">Comments</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code-Reuse"><span class="nav-number">4.1.6.</span> <span class="nav-text">Code Reuse</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Includes"><span class="nav-number">4.1.6.1.</span> <span class="nav-text">Includes</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Functors"><span class="nav-number">4.1.6.2.</span> <span class="nav-text">Functors</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-number">4.2.</span> <span class="nav-text">Reference</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Refs"><span class="nav-number">4.2.1.</span> <span class="nav-text">Refs</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Dynamic-Semantics"><span class="nav-number">4.2.1.1.</span> <span class="nav-text">Dynamic Semantics:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Static-Semantics"><span class="nav-number">4.2.1.2.</span> <span class="nav-text">Static Semantics</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Qingliu</span>

  

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
    Number of visitors: <span id="busuanzi_value_site_uv"></span>
</span>
</div>


<!--
<span class="post-meta-divider">|</span>



  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v6.5.0</div>



-->

<span class="post-meta-divider">|</span>

<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">Total 35.3k words</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>












  



  
    
      
  
  <script type="text/javascript" color="0,0,0" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script>













  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.5.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.5.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.5.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.5.0"></script>



  



  









  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
   <script type="text/javascript">
        var gitalk = new Gitalk({
          clientID: '69ff68eec89b6cd91e37',
          clientSecret: '200633852bdb3579481b3fecee7178c1b98f471e',
          repo: 'gitalk-comments',
          owner: 'Aden-Q',
          admin: ['Aden-Q'],
          id: location.pathname,
          distractionFreeMode: 'true'
        })
        gitalk.render('gitalk-container')           
       </script>


  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script>
    
    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url }) })
        .done(function ({ results }) {
          if (results.length > 0) {
            var counter = results[0];
            
            Counter('put', `/classes/Counter/${counter.objectId}`, JSON.stringify({ time: { "__op":"Increment", "amount":1 } }))
            
            .done(function () {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(counter.time + 1);
            })
            
            .fail(function ({ responseJSON }) {
                console.log('Failed to save Visitor num, with error message: ' + responseJSON.error);
            })
          } else {
            
              Counter('post', '/classes/Counter', JSON.stringify({ title: title, url: url, time: 1}))
                .done(function () {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(1);
                })
                .fail(function () {
                  console.log('Failed to create');
                });
            
          }
        })
      .fail(function ({ responseJSON }) {
        console.log('LeanCloud Counter Error:' + responseJSON.code + " " + responseJSON.error);
      });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + "TTkRYLVAOPvuxQuV5scOHl9U-gzGzoHsz")
        .done(function ({ api_server }) {
          var Counter = function (method, url, data) {
            return $.ajax({
              method: method,
              url: `https://${api_server}/1.1${url}`,
              headers: {
                'X-LC-Id': "TTkRYLVAOPvuxQuV5scOHl9U-gzGzoHsz",
                'X-LC-Key': "fCRGgKjo3tYIfbW3ygKrNCRN",
                'Content-Type': 'application/json',
              },
              data: data,
            });
          };
          
          addCount(Counter);
          
        })
    });
  </script>



  

  

  

  
  

  
  

  
    
      <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      },
      TeX: {equationNumbers: { autoNumber: "AMS" }}
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    
  


  
  

  

  

  

  

  

  


</body>
</html>
