<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.5.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.5.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.5.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.5.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Deeplearning.ai Specialization Course Notes">
<meta name="keywords" content="Programming,Python,Deep Learning,TensorFlow">
<meta property="og:type" content="article">
<meta property="og:title" content="Convolutional Neural Networks">
<meta property="og:url" content="http://yoursite.com/2019/04/25/Convolutional Neural Networks/index.html">
<meta property="og:site_name" content="Qingliu">
<meta property="og:description" content="Deeplearning.ai Specialization Course Notes">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-1.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-2.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-3.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-4.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-5.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-6.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-7.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-8.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-9.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-10.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-11.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-1.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-2.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-3.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-4.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-5.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-6.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-7.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-8.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-9.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-10.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-21.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-22.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-11.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-12.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-13.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-14.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-15.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-16.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-17.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-18.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-19.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-20.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-3.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-4.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-5.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-6.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-7.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-8.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-9.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-10.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-11.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-12.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-13.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-14.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-15.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-16.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-17.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-18.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-19.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-20.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-21.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-22.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-23.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-24.png">
<meta property="og:updated_time" content="2019-05-05T01:42:08.574Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Convolutional Neural Networks">
<meta name="twitter:description" content="Deeplearning.ai Specialization Course Notes">
<meta name="twitter:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-1.png">






  <link rel="canonical" href="http://yoursite.com/2019/04/25/Convolutional Neural Networks/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Convolutional Neural Networks | Qingliu</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

<a href="https://github.com/Aden-Q" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Qingliu</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/25/Convolutional Neural Networks/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qingliu">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Qingliu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Convolutional Neural Networks
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-04-25 23:11:34" itemprop="dateCreated datePublished" datetime="2019-04-25T23:11:34-05:00">2019-04-25</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-05-04 20:42:08" itemprop="dateModified" datetime="2019-05-04T20:42:08-05:00">2019-05-04</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Note/" itemprop="url" rel="index"><span itemprop="name">Note</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/04/25/Convolutional Neural Networks/" class="leancloud_visitors" data-flag-title="Convolutional Neural Networks">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Heat: </span>
               
                 <span class="leancloud-visitors-count"></span>
                 <span>℃</span>
             </span>
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             Views:  
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Deeplearning.ai Specialization</p>
<p>Course Notes</p>
<a id="more"></a>
<h1 id="Week-1"><a href="#Week-1" class="headerlink" title="Week 1"></a>Week 1</h1><h2 id="Foundations-of-Convolutional-Neural-Networks"><a href="#Foundations-of-Convolutional-Neural-Networks" class="headerlink" title="Foundations of Convolutional Neural Networks"></a>Foundations of Convolutional Neural Networks</h2><ul>
<li>Image Classification</li>
<li>Object detection</li>
<li>Neural Style Transfer</li>
</ul>
<p>With so many parameters, it’s difficult to get enough data for a model to get rid of overfitting.</p>
<p><strong>Edge Detection</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-1.png" style="zoom:60%"><br></center>



<p><strong>Convolution</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-2.png" style="zoom:60%"><br></center>

<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-3.png" style="zoom:60%"><br></center>



<p><strong>Padding</strong></p>
<p>Two problems:</p>
<ul>
<li>The image may shrink after some convolution</li>
<li>The blocks in the middle of image have a higher chance to be utilized than the ones on the border</li>
</ul>
<p>For a deep neural network, we really don’t want the image to shrink because we have many convolution operations. Without padding, the image may shrink after every layer and after maybe 100 layers, we end up with a very small matrix like 1 by 1. The other problem is that we throw away information from the edges of the image.</p>
<p>Traditionally without padding, if the original matrix is $n$ by $n$ and the filter is $f$ by $f$. Then the matrix after convolution will have a shape of $n-f+1$ by $n-f+1$</p>
<p>p: padding size</p>
<p>After padding, the final output matrix will have shape $n+2p-f+1$ by $n+2p-f+1$</p>
<p><strong>Valid and Same convolutions</strong></p>
<p>“Valid”: no padding, p = 0, nxn * fxf -&gt; n-f+1 x n-f+1</p>
<p>“Same”: Pad so that output size is the same as the input size. $p=\frac{f-1}{2}$</p>
<p>By convention, f is usually odd. The reasons:</p>
<ul>
<li>padding convience</li>
<li>Odd dimensional filter has a central position</li>
</ul>
<p><strong>Strided convolution</strong></p>
<p>shape formula:</p>
<p>nxn * fxf with padding p and stride s</p>
<p>output shape (square):<br>$$<br>\frac{n+2p-f}{s} + 1<br>$$</p>
<p><strong>Cross-correlation vs. convolution</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-4.png" style="zoom:60%"><br></center>

<p>In computer vision, we don’t bother to use the non-flipped one because the flip operation is redundant in real computer vision applications.</p>
<p><strong>Convolution over volumes</strong></p>
<p>For example, convolutions on RGB images</p>
<p>Notation:</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-5.png" style="zoom:60%"><br></center>

<p>The number of the channels of a image must match the number of channels of the filter.</p>
<p>Each time, do the 27 multiplications and add up the 27 numbers and get one entry.</p>
<p><strong>Multiple filters</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-6.png" style="zoom:60%"><br></center>

<p>Summary: $n\times n\times n_c$ <em> $f\times f \times n_c$ - &gt; $n-f+1$ </em> $n-f+1$ $\times n_c’$</p>
<p>$n_c’$ is the number of filters we use.</p>
<p>It seems that the more filters we use, the more features we can extract from an image. (like detecting two features simultaneously, vertical lines and horizontal lines…)</p>
<p><strong>One layer of convolutional network</strong></p>
<p>The number of parameters has nothing to do with the input images.</p>
<p>If layer l is a convolution layer:</p>
<p>$f^{[l]}$ = filter size</p>
<p>$p^{[l]}$ = padding</p>
<p>$s^{[l]}$ = stride</p>
<p>$n_c^{[l]}$ = number of filters</p>
<p>Each filter is: $f^{[l]}\times f^{[l]}\times n_c^{[l-1]}$</p>
<p>Activations: $a^{[l]}-&gt;n_H^{[l]} \times n_W^{[l]} \times n_C^{[l]}$</p>
<p>Weights: $f^{[l]}\times f^{[l]}\times n_c^{[l-1]}\times n_C^{[l]}$</p>
<p>Bias: $n_c^{[l]}$ - (1,1,1,$n_c^{[l]}$)</p>
<p>Input: $n_H^{[l-1]}\times n_W^{[l-1]}\times n_c{[l-1]}$</p>
<p>Output: $n_H^{[l]}\times n_W^{[l]}\times n_c^{[l]}$<br>$$<br>n^{[l]} = \lfloor \frac{n^{[l-1]}+2p^{[l]}-f^{[l]}}{s^{[l]}}+1    \rfloor<br>$$<br>$A^{[l]}$ -&gt; $m\times n_H^{[l]}\times n_W^{[l]} \times n_C^{[l]}$</p>
<p><strong>Example ConvNet</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-7.png" style="zoom:60%"><br></center>

<p>Types of layer in a convolutional network:</p>
<ul>
<li>Convolution (CONV)</li>
<li>Pooling (POOL)</li>
<li>Fully connnected (FC)</li>
</ul>
<p><strong>Pooling layers</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-8.png" style="zoom:60%"><br></center>

<p>Max pooling has no parameters to learn.</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-9.png" style="zoom:60%"><br></center>



<p>Max pooling is used much more in the neural network than average pooling.</p>
<p>Summary of pooling:</p>
<p>Hyperparameters:</p>
<ul>
<li>f: filter size</li>
<li><p>s: stride</p>
</li>
<li><p>Max or average pooling</p>
</li>
</ul>
<p>Common choice: f=2, s=2. Roughly shrink the height and width by a factor of 2. f=3, s=3 is also used sometimes.</p>
<p>padding is very very rare used when we do max pooling</p>
<p>Pooling layer reduces the height and width of the input. It helps reduce computation, as well as helps make feature detectors more invariant to its position in the input.</p>
<p>No parameters to learn!</p>
<p><strong>Neural network example</strong></p>
<p>Common patterns when we go deeper and deeper:</p>
<ul>
<li>The height and width will decrease</li>
<li>The number of channels will increase</li>
<li>One or more conv layers follow by a pooling layer. At the end follow by FC</li>
</ul>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-10.png" style="zoom:60%"><br></center>

<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-03-Week1-11.png" style="zoom:60%"><br></center>

<p>A lot of the parameters tend to be in FC. The activation tends to go down gradually when going deeper and deeper. If it drops too fast, that’s usually not great performance.</p>
<p><strong>Why convolution?</strong></p>
<p>Parameter sharing and sparsity of connections.</p>
<p>Reducing the number of parameters significantly</p>
<p>Parameter sharing: A feature detector (such as a vertical edge detector) that’s useful in one part of the image is probably useful in another part of the image such as the vertical edge detector.</p>
<p>Sparsity of connections: In each layer, each output value depends only on a small number of inputs.</p>
<p>Translation invariance</p>
<h2 id="Programming-Assignment-Convolutional-Model-step-by-step"><a href="#Programming-Assignment-Convolutional-Model-step-by-step" class="headerlink" title="Programming Assignment: Convolutional Model: step by step"></a>Programming Assignment: Convolutional Model: step by step</h2><p><a href="https://github.com/Aden-Q/Deep-Learning/blob/master/Convolutional Neural Networks/Week 1/Convolution%2Bmodel%2B-%2BStep%2Bby%2BStep%2B-%2Bv2.ipynb" target="_blank" rel="noopener">Convolutional Model: step by step</a></p>
<h2 id="Programming-Assignment-Convolutional-model-application"><a href="#Programming-Assignment-Convolutional-model-application" class="headerlink" title="Programming Assignment: Convolutional model: application"></a>Programming Assignment: Convolutional model: application</h2><p><a href="https://github.com/Aden-Q/Deep-Learning/blob/master/Convolutional Neural Networks/Week 1/Convolution%2Bmodel%2B-%2BApplication%2B-%2Bv1.ipynb" target="_blank" rel="noopener">Convolutional model: application</a></p>
<h1 id="Week-2"><a href="#Week-2" class="headerlink" title="Week 2"></a>Week 2</h1><h2 id="Deep-convolutional-models-case-studies"><a href="#Deep-convolutional-models-case-studies" class="headerlink" title="Deep convolutional models: case studies"></a>Deep convolutional models: case studies</h2><p>Read some research papers from the field of computer vision.</p>
<p>Classic networks:</p>
<ul>
<li>LeNet-5</li>
<li>AlexNet</li>
<li>VGG</li>
</ul>
<p>ResNet (152 layers)</p>
<p>Inception</p>
<p><strong>LeNet-5</strong></p>
<p>Goal: recognize hand written digits</p>
<p>Trained on grey scale images</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-1.png" style="zoom:60%"><br></center>

<p>Go from left to right, $n_H$ and $n_W$ tend to go down and $n_C$ tend to go up.</p>
<p><strong>AlexNet</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-2.png" style="zoom:60%"><br></center>



<p><strong>VGG-16</strong></p>
<p>CONV = 3x3 filters, s = 1, same</p>
<p>MAX-POOL = 2x2, s = 2</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-3.png" style="zoom:60%"><br></center>



<p><strong>Residual network (ResNet)</strong></p>
<p>skip connections (“short cut”)</p>
<p>Residual block:</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-4.png" style="zoom:60%"><br></center>

<p>Using residual block, we can train a much deeper neural networks.</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-5.png" style="zoom:60%"><br></center>

<p>In ResNet, there are a lot of “SAME” convolution to preserve dimension so at to carry out skip connection.</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-6.png" style="zoom:60%"><br></center>



<p><strong>Network in Network and 1x1 convolutions</strong></p>
<p>Imagine this like a “fully connected” layer</p>
<p>[Lin et al., 2013. Network in network]</p>
<p>This idea influence many other network architectures.</p>
<p>One useful example:</p>
<p>Shrinking the number of channels</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-7.png" style="zoom:60%"><br></center>

<p>This is very useful for building Inception neural network.</p>
<p><strong>Inception network</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-8.png" style="zoom:60%"><br></center>

<p>Do all the possible computation and concat them together.</p>
<p>The problem: computational cost</p>
<p>“Bottleneck layer”</p>
<p>Shrink the representation before increasing the size</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-9.png" style="zoom:60%"><br></center>

<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-10.png" style="zoom:60%"><br></center>

<p>So long as you implement this bottleneck layer with reason, you can shrink down the representation significant and don’t hurt the performance of the model.</p>
<p><strong>Inception module</strong></p>
<p>To deal with the problem of vanishing gradients: very deep network often have a gradient signal that goes to zero quickly, thus making gradient descent unbearably slow.</p>
<p>Two types of block:</p>
<ul>
<li>Identity block</li>
<li>Convolutional block</li>
</ul>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-21.png" style="zoom:60%"><br></center>

<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-22.png" style="zoom:60%"><br></center>



<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-11.png" style="zoom:60%"><br></center>



<p><strong>Inception network</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-12.png" style="zoom:60%"><br></center>

<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-13.png" style="zoom:60%"><br></center>



<p><strong>Transfer learning (a better strategy)</strong></p>
<p>ImageNet, MS COCO</p>
<p>When the training set is rather small, transfer learning is a good strategy.</p>
<p>Small training set (freeze more layers):</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-14.png" style="zoom:60%"><br></center>

<p>Large training set (freeze less layers):</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-15.png" style="zoom:60%"><br></center>

<p>A lot of data (freeze 0 layer):</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-16.png" style="zoom:60%"><br></center>

<p>Transfer is very worth consideration</p>
<p><strong>Data Augmentation</strong></p>
<p>Common augmentation method:</p>
<ul>
<li>Mirroring (frequently used)</li>
<li><p>Random Cropping (isn’t a perfect method while frequently used)</p>
</li>
<li><p>Rotation</p>
</li>
<li>Shearing</li>
<li><p>Local warping</p>
</li>
<li><p>Color shifting</p>
</li>
<li>PCA color augmentation</li>
</ul>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-17.png" style="zoom:60%"><br></center>

<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-18.png" style="zoom:60%"><br></center>

<p>Implementation details</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-19.png" style="zoom:60%"><br></center>

<p>Data augmentation also has many hyperparameters.</p>
<p>Two sources of knowledge in deep learning:</p>
<ul>
<li>Labeled data</li>
<li>Hand engineered features/network architecture/other components</li>
</ul>
<p><strong>Tips for doing well on benchmarks/winning competitions</strong></p>
<ul>
<li><p>Ensembling: Train several networks independently and average their outputs (3-15 networks typically, so slow, almost never used in a product)</p>
</li>
<li><p>Multi-crop at test time: Run classifier on multiple versions of test images and average results</p>
</li>
</ul>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week2-20.png" style="zoom:60%"><br></center>

<ul>
<li>Use architectures of networks published in the literature</li>
<li><p>Use open sourcfe implementations if possible</p>
</li>
<li><p>Use pretrained models and fine-tune on your dataset</p>
</li>
</ul>
<h2 id="Programming-Assignment-Keras-Tutorial"><a href="#Programming-Assignment-Keras-Tutorial" class="headerlink" title="Programming Assignment: Keras Tutorial"></a>Programming Assignment: Keras Tutorial</h2><p><a href="https://github.com/Aden-Q/Deep-Learning/blob/master/Convolutional Neural Networks/Week 2/Keras%2B-%2BTutorial%2B-%2BHappy%2BHouse%2Bv2.ipynb" target="_blank" rel="noopener">Keras Tutorial</a></p>
<h2 id="Programming-Assignment-Residual-Networks"><a href="#Programming-Assignment-Residual-Networks" class="headerlink" title="Programming Assignment: Residual Networks"></a>Programming Assignment: Residual Networks</h2><p><a href="https://github.com/Aden-Q/Deep-Learning/blob/master/Convolutional Neural Networks/Week 2/Residual%2BNetworks%2B-%2Bv2.ipynb" target="_blank" rel="noopener">Residual Networks</a></p>
<ul>
<li>Very deep “plain” networks don’t work in practice because they are hard to train due to vanishing gradients.</li>
<li>The skip-connections help to address the Vanishing Gradient problem. They also make it easy for a ResNet block to learn an identity function.</li>
<li>There are two main types of blocks: The identity block and the convolutional block.</li>
<li>Very deep Residual Networks are built by stacking these blocks together.</li>
</ul>
<h1 id="Week-3"><a href="#Week-3" class="headerlink" title="Week 3"></a>Week 3</h1><h2 id="Object-detection"><a href="#Object-detection" class="headerlink" title="Object detection"></a>Object detection</h2><p>Object localization</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-3.png" style="zoom:60%"><br></center>

<p>Defining the target label y</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-4.png" style="zoom:60%"><br></center>



<p><strong>Landmark detection</strong></p>
<p>Key position detection</p>
<p>Basis of emotion detection, computer graphics and pose detection</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-5.png" style="zoom:60%"><br></center>

<p>If you can hire labelers or label yourself a big enough data set to do the detection task, then a neural network can perform very well</p>
<p><strong>Sliding windows object detection algorithm</strong></p>
<ol>
<li><p>Choosing a window size</p>
</li>
<li><p>Slide the window accross the image with a fixed stride</p>
</li>
<li><p>Make detection on each position (feed into the ConvNet and make prediction)</p>
</li>
<li><p>Repeat with larger window</p>
</li>
</ol>
<p>Huge disadvantage: Computation cost</p>
<p><strong>Convolutional implementation of sliding window</strong></p>
<p>Turning FC layer into convolutional layers</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-6.png" style="zoom:60%"><br></center>

<p>Share computation:</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-7.png" style="zoom:60%"><br></center>



<p><strong>Bounding box predictions</strong></p>
<p>YOLO algorithm: You only look once</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-8.png" style="zoom:60%"><br></center>

<p>One single convolutional implementation</p>
<p>Efficient, works well for real-time object detection</p>
<p>Specify the bounding boxes: relative to the grid cell</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-9.png" style="zoom:60%"><br></center>

<p>YOLO: One of the hardest papers to read</p>
<p><strong>Intersection over Union (IoU)</strong></p>
<p>Evaluating object localization</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-10.png" style="zoom:60%"><br></center>



<p><strong>Non-max Suppression</strong></p>
<p>The problem is that some objects might be detected multiple times</p>
<p>Non-max Suppression make sure each object is detected only once</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-11.png" style="zoom:60%"><br></center>



<p><strong>Anchor boxes</strong></p>
<p>One grid detect multiple objects, overlapping objects</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-12.png" style="zoom:60%"><br></center>

<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-13.png" style="zoom:60%"><br></center>



<p><strong>YOLO algorithm</strong></p>
<p>None-max suppression in YOLO:</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-14.png" style="zoom:60%"><br></center>



<h2 id="Region-proposals"><a href="#Region-proposals" class="headerlink" title="Region proposals"></a>Region proposals</h2><p>R-CNN, Region with CNN, picking some regions to run CNN</p>
<p>The ways to choose regions: <strong>semantic segmentation</strong></p>
<p>Still quite slow</p>
<h2 id="Programming-Assignment-Car-detection-with-YOLOv2"><a href="#Programming-Assignment-Car-detection-with-YOLOv2" class="headerlink" title="Programming Assignment: Car detection with YOLOv2"></a>Programming Assignment: Car detection with YOLOv2</h2><p><a href="https://github.com/Aden-Q/Deep-Learning/blob/master/Convolutional Neural Networks/Week 3/Autonomous%2Bdriving%2Bapplication%2B-%2BCar%2Bdetection%2B-%2Bv3.ipynb" target="_blank" rel="noopener">Car detection with YOLOv2</a></p>
<p>YOLO model is very computationally expensive to train</p>
<p>Find intersection:</p>
<ul>
<li>You’ll also need to find the coordinates <code>(xi1, yi1, xi2, yi2)</code> of the intersection of two boxes. Remember that:<ul>
<li>xi1 = maximum of the x1 coordinates of the two boxes</li>
<li>yi1 = maximum of the y1 coordinates of the two boxes</li>
<li>xi2 = minimum of the x2 coordinates of the two boxes</li>
<li>yi2 = minimum of the y2 coordinates of the two boxes</li>
</ul>
</li>
<li>In order to compute the intersection area, you need to make sure the height and width of the intersection are positive, otherwise the intersection area should be zero. Use <code>max(height, 0)</code> and <code>max(width, 0)</code>.</li>
</ul>
<p><strong>What you should remember</strong>:</p>
<ul>
<li>YOLO is a state-of-the-art object detection model that is fast and accurate</li>
<li>It runs an input image through a CNN which outputs a 19x19x5x85 dimensional volume. </li>
<li>The encoding can be seen as a grid where each of the 19x19 cells contains information about 5 boxes.</li>
<li>You filter through all the boxes using non-max suppression. Specifically: <ul>
<li>Score thresholding on the probability of detecting a class to keep only accurate (high probability) boxes</li>
<li>Intersection over Union (IoU) thresholding to eliminate overlapping boxes</li>
</ul>
</li>
<li>Because training a YOLO model from randomly initialized weights is non-trivial and requires a large dataset as well as lot of computation, we used previously trained model parameters in this exercise. If you wish, you can also try fine-tuning the YOLO model with your own dataset, though this would be a fairly non-trivial exercise. </li>
</ul>
<h1 id="Week-4"><a href="#Week-4" class="headerlink" title="Week 4"></a>Week 4</h1><h2 id="Special-applications-Face-recognition-amp-Neural-style-transfer"><a href="#Special-applications-Face-recognition-amp-Neural-style-transfer" class="headerlink" title="Special applications: Face recognition &amp; Neural style transfer"></a>Special applications: Face recognition &amp; Neural style transfer</h2><p><strong>Face verification vs. face recognition</strong></p>
<p>Verification:</p>
<ul>
<li>Input image, name/ID</li>
<li>Output whether the input image is that of the claimed person</li>
<li>1:1</li>
</ul>
<p>Recognition</p>
<ul>
<li>Has a database of K persons</li>
<li>Get an input image</li>
<li>Output ID if the image is any of the K persons (or “not recognized”)</li>
</ul>
<p><strong>One-shot learning</strong></p>
<p>Learning from one example to recognize the person again</p>
<p>Strategy: Learning a “similarity” function</p>
<p>d(img1, img2) = degree of difference between images, and predict by difference</p>
<p><strong>Siamese network</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-15.png" style="zoom:60%"><br></center>

<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-16.png" style="zoom:60%"><br></center>



<p><strong>Triplet loss</strong></p>
<p>Always look at three images at a time: Anchor, Positive and Negative</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-17.png" style="zoom:60%"><br></center>

<p>Choosing the triplets A,P,N</p>
<p>During training, if A,P,N are chosen randomly, $d(A,P)+\alpha \le d(A,N)$ is easily satisfied.</p>
<p>Idea: Choose triplets that’re “hard” to train on. (refer to the paper FaceNet)</p>
<p>Popular way to name system:</p>
<ul>
<li>____ Net</li>
<li>Deep ____</li>
</ul>
<p><strong>Neural style transfer</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-18.png" style="zoom:60%"><br></center>



<p>Visualizing what a deep network is learning</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-19.png" style="zoom:60%"><br></center>



<p><strong>Cost function</strong><br>$$<br>J(G) = \alpha J_{content}(C,G)+\beta J_{style}(S,G)<br>$$</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-20.png" style="zoom:60%"><br></center>



<p><strong>Content cost function</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-21.png" style="zoom:60%"><br></center>



<p><strong>Style cost function</strong></p>
<p>Define style as correlation between activations across channels</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-22.png" style="zoom:60%"><br></center>



<p><strong>Convolutions in 2D and 1D</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-23.png" style="zoom:60%"><br></center>



<p><strong>3D convolution</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-05-04-Week3-24.png" style="zoom:60%"><br></center>



<h2 id="Programming-Assignment-Art-generation-with-Neural-Style-Transfer"><a href="#Programming-Assignment-Art-generation-with-Neural-Style-Transfer" class="headerlink" title="Programming Assignment: Art generation with Neural Style Transfer"></a>Programming Assignment: Art generation with Neural Style Transfer</h2><p><a href="https://github.com/Aden-Q/Deep-Learning/blob/master/Convolutional Neural Networks/Week 4/Art%2BGeneration%2Bwith%2BNeural%2BStyle%2BTransfer%2B-%2Bv2.ipynb" target="_blank" rel="noopener">Art generation with Neural Style Transfer</a></p>
<p>Neural Style Transfer (NST) uses a previously trained convolutional network, and builds on top of that.</p>
<h2 id="Programming-Assignment-Face-Recognition-for-the-Happy-House"><a href="#Programming-Assignment-Face-Recognition-for-the-Happy-House" class="headerlink" title="Programming Assignment: Face Recognition for the Happy House"></a>Programming Assignment: Face Recognition for the Happy House</h2><p><a href="https://github.com/Aden-Q/Deep-Learning/blob/master/Convolutional Neural Networks/Week 4/Face%2BRecognition%2Bfor%2Bthe%2BHappy%2BHouse%2B-%2Bv3.ipynb" target="_blank" rel="noopener">Face Recognition for the Happy House</a></p>
<ul>
<li>Face verification solves an easier 1:1 matching problem; face recognition addresses a harder 1:K matching problem.</li>
<li>The triplet loss is an effective loss function for training a neural network to learn an encoding of a face image.</li>
<li>The same encoding can be used for verification and recognition. Measuring distances between two images’ encodings allows you to determine whether they are pictures of the same person.</li>
</ul>

      
    </div>

    

    
    
    

    <div>
    
    <div>

    <div style="text-align:center;color: #ccc;font-size:14px;">-------------End of the article <i class="fa fa-paw"></i> Thanks for reading!-------------</div>

</div>
    
    </div>

    

    
       
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Programming/" rel="tag"><i class="fa fa-tag"></i> Programming</a>
          
            <a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a>
          
            <a href="/tags/Deep-Learning/" rel="tag"><i class="fa fa-tag"></i> Deep Learning</a>
          
            <a href="/tags/TensorFlow/" rel="tag"><i class="fa fa-tag"></i> TensorFlow</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/04/24/Structuring Machine Learning Projects/" rel="next" title="Structuring Machine Learning Projects">
                <i class="fa fa-chevron-left"></i> Structuring Machine Learning Projects
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/05/04/Sequence Models/" rel="prev" title="Sequence Models">
                Sequence Models <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div id="gitalk-container"></div>  
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Qingliu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">17</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                    <span class="site-state-item-count">1</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">17</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/Aden-Q" title="GitHub &rarr; https://github.com/Aden-Q" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:qian0102@umn.edu" title="E-Mail &rarr; mailto:qian0102@umn.edu" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://www.linkedin.com/in/azure-qian-11b128179" title="Linkedin &rarr; https://www.linkedin.com/in/azure-qian-11b128179" rel="noopener" target="_blank"><i class="fa fa-fw fa-linkedin"></i>Linkedin</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://www.facebook.com/zecheng.qian.7" title="FB Page &rarr; https://www.facebook.com/zecheng.qian.7" rel="noopener" target="_blank"><i class="fa fa-fw fa-facebook"></i>FB Page</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Week-1"><span class="nav-number">1.</span> <span class="nav-text">Week 1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Foundations-of-Convolutional-Neural-Networks"><span class="nav-number">1.1.</span> <span class="nav-text">Foundations of Convolutional Neural Networks</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Programming-Assignment-Convolutional-Model-step-by-step"><span class="nav-number">1.2.</span> <span class="nav-text">Programming Assignment: Convolutional Model: step by step</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Programming-Assignment-Convolutional-model-application"><span class="nav-number">1.3.</span> <span class="nav-text">Programming Assignment: Convolutional model: application</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Week-2"><span class="nav-number">2.</span> <span class="nav-text">Week 2</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Deep-convolutional-models-case-studies"><span class="nav-number">2.1.</span> <span class="nav-text">Deep convolutional models: case studies</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Programming-Assignment-Keras-Tutorial"><span class="nav-number">2.2.</span> <span class="nav-text">Programming Assignment: Keras Tutorial</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Programming-Assignment-Residual-Networks"><span class="nav-number">2.3.</span> <span class="nav-text">Programming Assignment: Residual Networks</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Week-3"><span class="nav-number">3.</span> <span class="nav-text">Week 3</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Object-detection"><span class="nav-number">3.1.</span> <span class="nav-text">Object detection</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Region-proposals"><span class="nav-number">3.2.</span> <span class="nav-text">Region proposals</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Programming-Assignment-Car-detection-with-YOLOv2"><span class="nav-number">3.3.</span> <span class="nav-text">Programming Assignment: Car detection with YOLOv2</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Week-4"><span class="nav-number">4.</span> <span class="nav-text">Week 4</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Special-applications-Face-recognition-amp-Neural-style-transfer"><span class="nav-number">4.1.</span> <span class="nav-text">Special applications: Face recognition &amp; Neural style transfer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Programming-Assignment-Art-generation-with-Neural-Style-Transfer"><span class="nav-number">4.2.</span> <span class="nav-text">Programming Assignment: Art generation with Neural Style Transfer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Programming-Assignment-Face-Recognition-for-the-Happy-House"><span class="nav-number">4.3.</span> <span class="nav-text">Programming Assignment: Face Recognition for the Happy House</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Qingliu</span>

  

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
    Number of visitors: <span id="busuanzi_value_site_uv"></span>
</span>
</div>


<!--
<span class="post-meta-divider">|</span>



  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v6.5.0</div>



-->

<span class="post-meta-divider">|</span>

<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">Total 29.5k words</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>












  



  
    
      
  
  <script type="text/javascript" color="0,0,0" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script>













  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.5.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.5.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.5.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.5.0"></script>



  



  









  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
   <script type="text/javascript">
        var gitalk = new Gitalk({
          clientID: '69ff68eec89b6cd91e37',
          clientSecret: '200633852bdb3579481b3fecee7178c1b98f471e',
          repo: 'gitalk-comments',
          owner: 'Aden-Q',
          admin: ['Aden-Q'],
          id: location.pathname,
          distractionFreeMode: 'true'
        })
        gitalk.render('gitalk-container')           
       </script>


  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script>
    
    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url }) })
        .done(function ({ results }) {
          if (results.length > 0) {
            var counter = results[0];
            
            Counter('put', `/classes/Counter/${counter.objectId}`, JSON.stringify({ time: { "__op":"Increment", "amount":1 } }))
            
            .done(function () {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(counter.time + 1);
            })
            
            .fail(function ({ responseJSON }) {
                console.log('Failed to save Visitor num, with error message: ' + responseJSON.error);
            })
          } else {
            
              Counter('post', '/classes/Counter', JSON.stringify({ title: title, url: url, time: 1}))
                .done(function () {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(1);
                })
                .fail(function () {
                  console.log('Failed to create');
                });
            
          }
        })
      .fail(function ({ responseJSON }) {
        console.log('LeanCloud Counter Error:' + responseJSON.code + " " + responseJSON.error);
      });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + "TTkRYLVAOPvuxQuV5scOHl9U-gzGzoHsz")
        .done(function ({ api_server }) {
          var Counter = function (method, url, data) {
            return $.ajax({
              method: method,
              url: `https://${api_server}/1.1${url}`,
              headers: {
                'X-LC-Id': "TTkRYLVAOPvuxQuV5scOHl9U-gzGzoHsz",
                'X-LC-Key': "fCRGgKjo3tYIfbW3ygKrNCRN",
                'Content-Type': 'application/json',
              },
              data: data,
            });
          };
          
          addCount(Counter);
          
        })
    });
  </script>



  

  

  

  
  

  
  

  
    
      <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      },
      TeX: {equationNumbers: { autoNumber: "AMS" }}
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    
  


  
  

  

  

  

  

  

  


</body>
</html>
