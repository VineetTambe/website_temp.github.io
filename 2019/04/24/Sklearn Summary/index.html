<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.5.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.5.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.5.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.5.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Scikit-learn Summary">
<meta name="keywords" content="Programming,Python,Deep Learning,TensorFlow,Keras,Machine Learning,Scikit-learn">
<meta property="og:type" content="article">
<meta property="og:title" content="Scikit-learn Summary">
<meta property="og:url" content="http://yoursite.com/2019/04/24/Sklearn Summary/index.html">
<meta property="og:site_name" content="Qingliu">
<meta property="og:description" content="Scikit-learn Summary">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-1.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-2.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-3.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-4.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-5.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-6.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-7.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-8.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-9.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-10.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-7.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-8.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-9.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-1.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-4.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-2.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-3.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-5.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-11.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-12.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-13.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-14.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-15.png">
<meta property="og:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-16.png">
<meta property="og:updated_time" content="2019-05-03T18:55:56.773Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Scikit-learn Summary">
<meta name="twitter:description" content="Scikit-learn Summary">
<meta name="twitter:image" content="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-1.png">






  <link rel="canonical" href="http://yoursite.com/2019/04/24/Sklearn Summary/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Scikit-learn Summary | Qingliu</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

<a href="https://github.com/Aden-Q" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Qingliu</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/24/Sklearn Summary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qingliu">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Qingliu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Scikit-learn Summary
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-04-24 23:17:34" itemprop="dateCreated datePublished" datetime="2019-04-24T23:17:34-05:00">2019-04-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-05-03 13:55:56" itemprop="dateModified" datetime="2019-05-03T13:55:56-05:00">2019-05-03</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Note/" itemprop="url" rel="index"><span itemprop="name">Note</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/04/24/Sklearn Summary/" class="leancloud_visitors" data-flag-title="Scikit-learn Summary">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Heat: </span>
               
                 <span class="leancloud-visitors-count"></span>
                 <span>℃</span>
             </span>
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             Views:  
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Scikit-learn</p>
<p>Summary</p>
<a id="more"></a>
<h1 id="ML-Methods"><a href="#ML-Methods" class="headerlink" title="ML Methods"></a>ML Methods</h1><ul>
<li><p>Decision tree </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line">model = DecisionTreeRegressor(random_state=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>Random forest</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor</span><br><span class="line">model = RandomForestRegressor(n_estimators=<span class="number">100</span>, random_state=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>Model selection</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line">train_X, val_X, train_y, val_y = train_test_split(X, y, train_size=<span class="number">0.8</span>, test_size=<span class="number">0.2</span>, random_state=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Evaluation metrics</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_absolute_error</span><br><span class="line">val_mae = mean_absolute_error(val_prediction, val_y)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Save to csv</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">output = pd.DataFrame(&#123;<span class="string">'Id'</span>: test_data.Id, </span><br><span class="line">                       <span class="string">'SalePrice'</span>: test_preds&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Imputation</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.impute <span class="keyword">import</span> SimpleImputer</span><br><span class="line"><span class="comment"># Imputation</span></span><br><span class="line">my_imputer = SimpleImputer()</span><br><span class="line">imputed_X_train = pd.DataFrame(my_imputer.fit_transform(X_train))</span><br><span class="line">imputed_X_valid = pd.DataFrame(my_imputer.transform(X_valid))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Imputation removed column names; put them back</span></span><br><span class="line">imputed_X_train.columns = X_train.columns</span><br><span class="line">imputer_X_valid.columns = X_valid.columns</span><br><span class="line"></span><br><span class="line"><span class="comment"># Extension to Imputation</span></span><br><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> cols_with_missing:</span><br><span class="line">    X_train_plus[col + <span class="string">'_was_missing'</span>] = X_train_plus[col].isnull()</span><br><span class="line">    X_valid_plus[col + <span class="string">'_was_missing'</span>] = X_valid_plus[val].isnull()</span><br></pre></td></tr></table></figure>
</li>
<li><p>Numerical selection</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X = X_full.select_dtypes(exclude=[<span class="string">'object'</span>])</span><br></pre></td></tr></table></figure>
</li>
<li><p>Drop NA</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cols_with_missing = [col <span class="keyword">in</span> X_train.columns <span class="keyword">if</span> X_train[col].isnull().any()]</span><br><span class="line">X_train = X_train.drop(cols_with_missing, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Drop Categorical Variables (typically perform worst)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">drop_X_train = X_train.select_dtypes(exclude=[<span class="string">'object'</span>])</span><br><span class="line">drop_X_valid = X_valid.select_dtypes(exclude=[<span class="string">'object'</span>])</span><br></pre></td></tr></table></figure>
</li>
<li><p>Label Encoding (randomly)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line">label_X_train = X_train.copy()</span><br><span class="line">label_X_valid = X_valid.copy()</span><br><span class="line">label_encoder = LabelEncoder()</span><br><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> object_cols:</span><br><span class="line">    label_X_train[col] = label_encoder.fit_transform(X_train[col])</span><br><span class="line">    label_X_valid[col] = label_encoder.transform(X_valid[col])</span><br></pre></td></tr></table></figure>
</li>
<li><p>One-Hot Encoding (typically perform best)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> OneHotEncoder</span><br><span class="line">OH_encoder = OneHotEncoder(handle_unknown=<span class="string">'ignore'</span>, sparse=<span class="keyword">False</span>)</span><br><span class="line">OH_cols_train = pd.DataFrame(OH_encoder.fit_transform(X_train[object_cols]))</span><br><span class="line">OH_cols_valid = pd.DataFrame(OH_encoder.transform(X_valid[object_cols]))</span><br><span class="line"><span class="comment"># One-hot encoding removed index; put it back</span></span><br><span class="line">OH_cols_train.index = X_train.index</span><br><span class="line">OH_cols_valid.index = X_valid.index</span><br><span class="line"><span class="comment"># Remove categorical columns</span></span><br><span class="line">num_X_train = X_train.drop(object_cols, axis=<span class="number">1</span>)</span><br><span class="line">num_X_valid = X_valid.drop(object_cols, axis=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># Add one-hot encoded columns to numerical features</span></span><br><span class="line">OH_X_train = pd.concat([num_X_train, OH_cols_train], axis=<span class="number">1</span>)</span><br><span class="line">OH_X_valid = pd.concat([num_X_train, OH_cols_valid], axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># pandas implementation</span></span><br><span class="line">X_train = pd.get_dummies(X_train)</span><br><span class="line">X_valid = pd.get_dummies(X_valid)</span><br><span class="line">X_test = pd.get_dummies(X_test)</span><br><span class="line">X_train, X_valid = X_train.align(X_valid, join=<span class="string">'left'</span>, axis=<span class="number">1</span>)</span><br><span class="line">X_train, X_test = X_train.align(X_test, join=<span class="string">'left'</span>, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Remove rows with missing target</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X.dropna(axis=<span class="number">0</span>, subset=[<span class="string">'SalePrice'</span>, inplace=<span class="keyword">True</span>])</span><br></pre></td></tr></table></figure>
</li>
<li><p>Object columns selection</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">object_cols = [col <span class="keyword">for</span> col <span class="keyword">in</span> X_train.columns <span class="keyword">if</span> X_train[col].dtype == <span class="string">"object"</span>]</span><br><span class="line"><span class="comment"># Columns that can be safely label encoded</span></span><br><span class="line">good_label_cols = [col <span class="keyword">for</span> col <span class="keyword">in</span> object_cols <span class="keyword">if</span> set(X_train[col]) == set(X_valid[col])]</span><br><span class="line"><span class="comment"># Problematic columns that will be dropped from the dataset</span></span><br><span class="line">bad_label_cols = list(set(object_cols)-set(good_label_cols)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Ont-Hot columns selection</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">low_cardinality_cols = [col <span class="keyword">for</span> col <span class="keyword">in</span> object_cols <span class="keyword">if</span> X_train[col].nunique() &lt; <span class="number">10</span>]</span><br><span class="line">high_cardinality_cols = list(set(object_cols)-set(low_cardinality_cols))</span><br></pre></td></tr></table></figure>
</li>
<li><p>Pipelines</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.compose <span class="keyword">import</span> ColumnTransformer</span><br><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</span><br><span class="line"><span class="comment"># from sklearn.pipeline import make_pipeline # used when there is no data preprocessing</span></span><br><span class="line"><span class="keyword">from</span> sklearn.impute <span class="keyword">import</span> SimpleImputer</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> OneHotEncoder</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_absolute_error</span><br><span class="line"><span class="comment"># Preprocessing for numerical data</span></span><br><span class="line">numerical_transformer = SimpleImputer(strategy=<span class="string">'constant'</span>)</span><br><span class="line"><span class="comment"># Preprocessing for categorical data</span></span><br><span class="line">categorical_transformer = Pipeline(steps=[</span><br><span class="line">    (<span class="string">'imputer'</span>, SimpleImputer(strategy=<span class="string">'most_frequent'</span>)),</span><br><span class="line">    (<span class="string">'onehot'</span>, OneHotEncoder(handdle_unknown=<span class="string">'ignore'</span>))</span><br><span class="line">])</span><br><span class="line"><span class="comment"># Bundle preprocessing for numerical and categorical data</span></span><br><span class="line">preprocessor = ColumnTransformer(</span><br><span class="line">	transformers=[</span><br><span class="line">        (<span class="string">'num'</span>, numerical_transformer, numerical_cols),</span><br><span class="line">        (<span class="string">'cat'</span>, categorical_transformer, categorical_cols)</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"><span class="comment"># Bundle preprocessing and modeling code in a pipeline</span></span><br><span class="line">my_pipeline = Pipeline(steps=[(<span class="string">'preprossor'</span>, preprocessor),</span><br><span class="line">                              (<span class="string">'model'</span>, model)</span><br><span class="line">                             ])</span><br><span class="line"><span class="comment"># Preprocessing of training data, fit model</span></span><br><span class="line">my_pipeline.fit(X_train, y_train)</span><br><span class="line"><span class="comment"># Preprocessing of validation data, get predictions</span></span><br><span class="line">preds = my_pipeline.predict(X_valid)</span><br><span class="line"><span class="comment"># Evaluate the model</span></span><br><span class="line">score = mean_absolute_error(y_valid, preds)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Proper columns selection</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Select categorical columns with relatively low cardinality</span></span><br><span class="line">categorical_cols = [cname <span class="keyword">for</span> cname <span class="keyword">in</span> X_train_full.columns <span class="keyword">if</span> 		</span><br><span class="line">                    X_train_full[cname].nunique() &lt; <span class="number">10</span> <span class="keyword">and</span></span><br><span class="line">                    X_train_full[cname].dtype == <span class="string">'object'</span>]</span><br><span class="line"><span class="comment"># Select numerical columns</span></span><br><span class="line">numerical_cols = [cname <span class="keyword">for</span> cname <span class="keyword">in</span> X_train_full.columns <span class="keyword">if</span></span><br><span class="line">                  X_train_full[cname].dtype <span class="keyword">in</span> [<span class="string">'int64'</span>, <span class="string">'float64'</span>]]</span><br></pre></td></tr></table></figure>
</li>
<li><p>Read in data</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X_full = pd.read_csv(<span class="string">'../input/train.csv'</span>, index_col=<span class="string">'Id'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Output data</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">output = pd.DataFrame(&#123;<span class="string">'Id'</span>: X_test.index,</span><br><span class="line">                       <span class="string">'SalePrice'</span>: preds_test&#125;)</span><br><span class="line">output.to_csv(<span class="string">'submission.csv'</span>, index=<span class="keyword">False</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Cross validation</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line">score = <span class="number">-1</span> * cross_val_score(my_pipeline, X, y</span><br><span class="line">                             cv=<span class="number">5</span>,	<span class="comment"># 5 folds cross validation</span></span><br><span class="line">                             scoring=<span class="string">'neg_mean_absolute_error'</span>) <span class="comment"># scoring='accuracy' for classification problem</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>XGBoost</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> xgboost <span class="keyword">import</span> XGBRegressor</span><br><span class="line"></span><br><span class="line">my_model = XGBRegressor()</span><br><span class="line"><span class="comment"># my_model = XGBRegressor(n_estimators=500)</span></span><br><span class="line"><span class="comment"># my_model.fit(X_train, y_train,</span></span><br><span class="line"><span class="comment">#			   early_stopping_rounds=5,</span></span><br><span class="line"><span class="comment">#    		   eval_set=[(X_valid, y_valid)],</span></span><br><span class="line"><span class="comment">#              verbose=False)</span></span><br><span class="line"><span class="comment"># my_model = XGBRegressor(n_estimators=1000, learning_rate=0.05)</span></span><br><span class="line"><span class="comment"># my_model = XGBRegressor(n_estimators=1000, learning_rate=0.05, n_jobs=4)</span></span><br><span class="line">my_model.fit(X_train, y_train)</span><br></pre></td></tr></table></figure>
<p>parameters:</p>
<ul>
<li><code>n_estimators</code>: specifies how many times to go through the modeling cycle. low: underfuttubg, high: overfitting. Typically value is 100-1000.</li>
<li><code>early_stopping_rounds</code>: this parameter causes the model to stop iterating when the validation scores stops improving. It’s smart to set a high value for <code>n_estimators</code> and then use <code>early_stopping_rounds</code> to find the optimal time to stop iterating. Since random chance sometimes causes a single round where validation scores don’t improve, you nedd to specify a number for how many rounds of straight deterioration to allow before stopping. Setting <code>early_stopping_rounds=5</code> is a reasonable choice. In this case, we stop after 5 straight rounds of deteriorating validation scores.</li>
<li><code>learning_rate</code>: Instead of getting predictions by simply adding up the predictions from each component model, we can multiply the predictions from each model by a small number (known as the <strong>learning rate</strong>) before adding them in. In general, a small learning rate and large number of estimators will yield more accurate XGBoost models, through it will also take the model longer to train since it does more iterations through the cycle. As default, XGBoost sets <code>learning_rate=0.1</code>.</li>
<li><code>n_jobs</code>: On large datasets where runtime is a consideration, you can use parallelism to build your model faster. It’s common to set the parameter <code>n_jobs</code> equal to the number of cores on your machine. On smaller datasets, this won’t help.</li>
</ul>
</li>
<li><p>Data leakage: target leakage and train-test contamination.</p>
<ul>
<li>Target leakage: Any variable updated (or created) after the target value is realized should be excluded. Data exploration can really help identify target leakage.</li>
<li>Train-test contamination: Happens when validation data affects the preprocessing behavior. If the validation is based on a simple train-test split, exclude the validation from any type of fitting, including the fitting of preprocessing steps. Careful separation of training and validation data can prevent train-test contamination and pipelines can help.</li>
</ul>
</li>
</ul>
<p><strong>Machine Learning Pipeline</strong></p>
<ol>
<li>Define Preprocessing Steps</li>
<li>Define the Model</li>
<li>Create and Evaluate the Pipeline</li>
</ol>
<h1 id="Pandas"><a href="#Pandas" class="headerlink" title="Pandas"></a>Pandas</h1><ul>
<li><p>Creating data: <strong>DataFrame</strong> and <strong>Series</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DataFrame</span></span><br><span class="line">pd.DataFrame(&#123;<span class="string">'Yes'</span>: [<span class="number">50</span>, <span class="number">21</span>], <span class="string">'No'</span>: [<span class="number">131</span>, <span class="number">2</span>]&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DataFrame with customized index (row labels)</span></span><br><span class="line">pd.DataFrame(&#123;<span class="string">'Bob'</span>: [<span class="string">'I liked it.'</span>, <span class="string">'It was awful.'</span>], </span><br><span class="line">              <span class="string">'Sue'</span>: [<span class="string">'Pretty good.'</span>, <span class="string">'Bland.'</span>]&#125;,</span><br><span class="line">             index=[<span class="string">'Product A'</span>, <span class="string">'Product B'</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Series</span></span><br><span class="line">pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line"><span class="comment"># Series with a name</span></span><br><span class="line">pd.Series([<span class="number">30</span>, <span class="number">35</span>, <span class="number">40</span>], index=[<span class="string">'2015 Sales'</span>, <span class="string">'2016 Sales'</span>, <span class="string">'2017 Sales'</span>], name=<span class="string">'Product A'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Read file</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wine_reviews = pd.read_csv(<span class="string">"../input/wine-reviews/winemag-data-130k-v2.csv"</span>, index_col=<span class="number">0</span>) <span class="comment"># set the index column (otherwise pandas will create a default column)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Summary functions (type-aware)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.describe()</span><br></pre></td></tr></table></figure>
</li>
<li><p>List unique values</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reviews.taster_name.unique()</span><br><span class="line">reviews.taster_name.value_counts()	<span class="comment"># unique value counts</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Maps</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Series.map</span></span><br><span class="line">review_point_mean = reviews.points.mean()</span><br><span class="line">reviews_points.map(<span class="keyword">lambda</span> p: p - review_point_mean)</span><br><span class="line"><span class="comment"># Apply to a whole DataFrame</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remean_points</span><span class="params">(row)</span>:</span></span><br><span class="line">    row.points = row.points - review_points_mean</span><br><span class="line">    <span class="keyword">return</span> row</span><br><span class="line"></span><br><span class="line">reviews.apply(remean_points, axis=<span class="string">'columns'</span>)</span><br><span class="line"><span class="comment"># Alternative way (faster)</span></span><br><span class="line">review_points_mean = reviews.points.mean()</span><br><span class="line">review.points - review_points_mean</span><br></pre></td></tr></table></figure>
</li>
<li><p>Group and sorting</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">reviews.groupby(<span class="string">'points'</span>).points.count()</span><br><span class="line">reviews.groupby(<span class="string">'points'</span>).price.min()</span><br><span class="line"><span class="comment"># Value counts</span></span><br><span class="line">reviews_per_region = reviews.region_1.fillna(<span class="string">'Unknown'</span>).value_counts().sort_values(ascending=<span class="keyword">False</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">countries_reviewd = countries_reviewd.reset_index()</span><br><span class="line">countries_reviewd.sort_values(by=<span class="string">'len'</span>, ascending=<span class="keyword">True</span>)</span><br><span class="line"><span class="comment"># Sort by index</span></span><br><span class="line">countries_reviewd.sort_index()</span><br><span class="line"><span class="comment"># Sort with multiple keys</span></span><br><span class="line">countries_reviewd.sort_values(by=[<span class="string">'country'</span>, <span class="string">'len'</span>])</span><br></pre></td></tr></table></figure>
</li>
<li><p>Data types</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">reviews.price.dtype	<span class="comment"># Get type for a single column</span></span><br><span class="line">reviews.dtypes	<span class="comment"># Get types for all columns</span></span><br><span class="line">reviews.points.astype(<span class="string">'float64'</span>)	<span class="comment"># Change data type</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Missing data</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reviews[reviews.country.isnull()]</span><br><span class="line">reviews.region_2.fillna(<span class="string">"Unknown"</span>)	<span class="comment"># Fill in NA data entries</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Rename (specifying a <code>index</code> or <code>column</code> keyword parameter)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">reviews.rename(columns=&#123;<span class="string">'points'</span>: <span class="string">'score'</span>&#125;)</span><br><span class="line">reviews.rename(index=&#123;<span class="number">0</span>: <span class="string">'firstEntry'</span>, <span class="number">1</span>: <span class="string">'secondEntry'</span>&#125;)	<span class="comment"># Rarely</span></span><br><span class="line">reviews.rename_axis(<span class="string">"wines"</span>, axis=<span class="string">'rows'</span>).rename_axis(<span class="string">"fields"</span>, axis=<span class="string">'columns'</span>)	<span class="comment"># Set names for row index and column index</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Combining (<code>concat</code>, <code>join</code>, <code>merge</code>)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([canadian_youtube, british_youtube])</span><br></pre></td></tr></table></figure>
</li>
<li><p>Indexing</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Single row</span></span><br><span class="line">df.iloc[<span class="number">2</span>]	<span class="comment"># Make sure to specify a number, zero index</span></span><br><span class="line">df.loc[<span class="string">'BADL'</span>]	<span class="comment"># Make sure to pass a value from dataframes's index</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Multiple rows</span></span><br><span class="line">df.loc[[<span class="string">'BADL'</span>, <span class="string">'ARCH'</span>, <span class="string">'ACAD'</span>]]</span><br><span class="line">df.iloc[[<span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>]]</span><br><span class="line">df[:<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Indexing columns</span></span><br><span class="line">df[<span class="string">'State'</span>].head(<span class="number">3</span>)</span><br><span class="line">df.State.head(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Clean the column names</span></span><br><span class="line">df.columns = [col.replace(<span class="string">' '</span>, <span class="string">'_'</span>).lower() <span class="keyword">for</span> col <span class="keyword">in</span> df.columns]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Indexing columns and rows</span></span><br><span class="line">df[[<span class="string">'state'</span>, <span class="string">'acres'</span>]][:<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Indexing scalar value</span></span><br><span class="line">df.state.iloc[<span class="number">2</span>]	<span class="comment"># return a scalar rather than a Series or DataFrame</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Boolean indexing</span></span><br><span class="line">df[df.state == <span class="string">'UT'</span>]</span><br><span class="line"><span class="comment"># Some helpful logical operations: ~: not; |: or; &amp;: and</span></span><br><span class="line"><span class="comment"># E.g.</span></span><br><span class="line">df[(df.latitude &gt; <span class="number">60</span>) | (df.acres &gt; <span class="number">10</span>**<span class="number">6</span>)].head(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># isin and isnull</span></span><br><span class="line">df[df.state.isin([<span class="string">'WA'</span>, <span class="string">'OR'</span>, <span class="string">'CA'</span>])].head()</span><br></pre></td></tr></table></figure>
</li>
<li><p>Bar charts and categorical data (nominal categories and ordinal categories)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews[<span class="string">'province'</span>].value_counts().head(<span class="number">10</span>).plot.bar()</span><br></pre></td></tr></table></figure>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-1.png" style="zoom:70%"><br></center>
</li>
<li><p>Line charts</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews[<span class="string">'points'</span>].value_counts().sort_index().plot.line()</span><br></pre></td></tr></table></figure>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-2.png" style="zoom:70%"><br></center>
</li>
<li><p>Area charts (line charts with the bottom shaded in)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews[<span class="string">'point'</span>].value_count().sort_index().plot.area()</span><br></pre></td></tr></table></figure>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-3.png" style="zoom:70%"><br></center>
</li>
<li><p>Histograms (work best for interval variables without skew or for ordinal categorical variables)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews[reviews[<span class="string">'price'</span>] &lt; <span class="number">200</span>][<span class="string">'price'</span>].plot.hist()</span><br></pre></td></tr></table></figure>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-4.png" style="zoom:70%"><br></center>
</li>
<li><p>Scatter plot (remember to downsample to avoid duplicate), works best with relatively small datasets and large number of unique values</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">review[reviews[<span class="string">'price'</span>] &lt; <span class="number">100</span>].sample(<span class="number">100</span>).plot.scatter(x=<span class="string">'price'</span>, y=<span class="string">'points'</span>)</span><br></pre></td></tr></table></figure>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-5.png" style="zoom:70%"><br></center>
</li>
<li><p>Hexplot</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews[reviews[<span class="string">'price'</span>] &lt; <span class="number">100</span>].plot.hexbin(x=<span class="string">'price'</span>, y=<span class="string">'points'</span>, gridsize=<span class="number">15</span>)</span><br></pre></td></tr></table></figure>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-6.png" style="zoom:70%"><br></center>
</li>
<li><p>Stacked plots (work best for nominal categorical or small ordinal categorical variables)</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-7.png" style="zoom:70%"><br></center>

<p>One categorical variable in the columns, one categorical variable in the rows, and counts of their intersection in the entries.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wine_counts.plot.bar(stacked=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-8.png" style="zoom:70%"><br></center>

<p>Area plot</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-9.png" style="zoom:70%"><br></center>
</li>
<li><p>Bivariate line chart</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wine_counts.plot.line()</span><br></pre></td></tr></table></figure>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-10.png" style="zoom:70%"><br></center>





</li>
</ul>
<h1 id="Seaborn"><a href="#Seaborn" class="headerlink" title="Seaborn"></a>Seaborn</h1><ul>
<li><p>Line charts</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.figure(figsize=(<span class="number">14</span>,<span class="number">6</span>))</span><br><span class="line">plt.title(<span class="string">"Daily Global Streams of Popular Songs in 2017-2018"</span>)</span><br><span class="line">sns.lineplot(daat=fifa_data)	<span class="comment"># plot a line for every column in the dataset</span></span><br><span class="line"><span class="comment"># sns.lineplot(data=spotyfy_data['Shape of You'], label="Shape of You")	# plot one column, label represents adding legend</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Bar charts</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">6</span>))</span><br><span class="line">plt.title(<span class="string">"..."</span>)</span><br><span class="line">sns.barplot(x=flight_data.index, y=flight_data=[<span class="string">'NK'</span>])</span><br></pre></td></tr></table></figure>
</li>
<li><p>Heatmap</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">14</span>,<span class="number">7</span>))</span><br><span class="line">plt.title(<span class="string">"..."</span>)</span><br><span class="line">sns.heatmap(data=flight_data, annot=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Scatter plot</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.scatterplot(x=insurance_data[<span class="string">'bmi'</span>], y=[insurance_data[<span class="string">'charges'</span>]])</span><br><span class="line"><span class="comment"># Add a regression line</span></span><br><span class="line">sns.regplot(x=insurance_data[<span class="string">'bmi'</span>], y=insurance_data[<span class="string">'charges'</span>])</span><br><span class="line"><span class="comment"># Color code with a boolean/categorical column</span></span><br><span class="line">sns.scatterplot(x=insurance_data[<span class="string">'bmi'</span>], y=insurance_data[<span class="string">'charges'</span>], hue=insurance_data[<span class="string">'smoker'</span>])</span><br><span class="line"><span class="comment"># Two regression line</span></span><br><span class="line">sns.lmplot(x=<span class="string">"bmi"</span>, y=<span class="string">"charges"</span>, hue=<span class="string">"smoker"</span>, data=insurance_data)</span><br><span class="line"><span class="comment"># Categorical scatter plot</span></span><br><span class="line">sns.swarmplot(x=insurance_data[<span class="string">'smoker'</span>],</span><br><span class="line">              y=insurance_data[<span class="string">'charges'</span>])</span><br></pre></td></tr></table></figure>
<p><strong>One regression line</strong></p>
</li>
</ul>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-7.png" style="zoom:50%"><br></center>

<p>​        <strong>Two regression lines (hue specified, color coded)</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-8.png" style="zoom:50%"><br></center>

<p>​        <strong>Categorical scatter plot</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-9.png" style="zoom:50%"><br></center>

<ul>
<li><p>Histograms</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.distplot(a=iris_data[<span class="string">'Petal Length (cm)'</span>], kde=<span class="keyword">False</span>, bins=<span class="number">5</span>)</span><br><span class="line"><span class="comment"># a: choose the column we'd like to plot</span></span><br><span class="line"><span class="comment"># kde=False (always included in a histogram)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Histograms for multiple columns</span></span><br><span class="line">sns.distplot(a=iris_set_data[<span class="string">'Petal Length (cm)'</span>], label=<span class="string">'Iris-setosa'</span>, kde=<span class="keyword">False</span>)</span><br><span class="line">sns.distplot(a=iris_ver_data[<span class="string">'Petal Length (cm)'</span>], label=<span class="string">'Iris-versicolor'</span>, kde=<span class="keyword">False</span>)</span><br><span class="line">sns.distplot(a=iris_vir_data[<span class="string">'Petal Length (cm)'</span>], label=<span class="string">'Iris-virginica'</span>, kde=<span class="keyword">False</span>)</span><br><span class="line">plt.legend()	<span class="comment"># Force legend to appear</span></span><br></pre></td></tr></table></figure>
<p>​        <strong>General higtogram</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-1.png" style="zoom:50%"><br></center>

<p><strong>Histogram of multiple columns</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-4.png" style="zoom:50%"><br></center>
</li>
<li><p>Density plots</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.kdeplot(data=iris_data[<span class="string">'Petal Length (cm)'</span>], shade=<span class="keyword">True</span>)</span><br><span class="line"><span class="comment"># 2D kde plots</span></span><br><span class="line">sns.jointplot(x=iris_data[<span class="string">'Petal Length (cm)'</span>], y=iris_data[<span class="string">'Sepal Width (cm)'</span>], kind=<span class="string">"kde"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># KDE plot for multiple columns</span></span><br><span class="line">sns.kdeplot(data=iris_set_data[<span class="string">'Petal Length (cm)'</span>], label=<span class="string">'Iris-setosa'</span>, shade=<span class="keyword">True</span>)	<span class="comment"># shade is used to fill in the color below the KDE plot</span></span><br><span class="line"><span class="comment"># and so on</span></span><br></pre></td></tr></table></figure>
<p>​        <strong>General KDE plot</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-2.png" style="zoom:50%"><br></center>

<p>​        <strong>2D KDE plot</strong></p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-3.png" style="zoom:50%"><br></center>

<pre><code>**KDE plot for multiple columns**
</code></pre><center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-29-5.png" style="zoom:50%"><br></center>
</li>
<li><p>Choosing the best type of chart</p>
<ul>
<li><strong>Trends</strong>: A trend is defined as a pattern of change.<ul>
<li><code>sns.lineplot</code> - <strong>Line charts</strong> are the best to show trends over a period of time, and multiple lines can be used to show trends in more than one  group.</li>
</ul>
</li>
<li><strong>Relationship</strong>: There are many different chart for show this.<ul>
<li><code>sns.barplot</code>- <strong>Bar charts</strong> are useful for comparing quantities corresponding to different groups.</li>
<li><code>sns.heatmap</code>- <strong>Heatmaps</strong> can be used to find color-coded patterns in table  of numbers.</li>
<li><code>sns.scatterplot</code>- <strong>Scatter plots</strong> show the relation between two continuous variables; if color-coded, we can also show the relationship with categorical variables.</li>
<li><code>sns.regplot</code>- Including a <strong>regression line</strong> in the  scatter plot makes it easier to see linear relationship between two variables.</li>
<li><code>sns.lmplot</code>- This command is useful for drawing multiple regression lines, if the scatter plot contains multiple, color-coded groups.</li>
<li><code>sns.swarmplot</code>- <strong>Categorical scatter plots</strong> show the relationship between a continuous variable and a categorical variable.</li>
</ul>
</li>
<li><strong>Distribution</strong>: We visualize distribution to show the possible values that we can expect to see in a variable.<ul>
<li><code>sns.distplot</code>- <strong>Histograms</strong> show the distribution of a single numerical variable.</li>
<li><code>sns.kdeplot</code>- <strong>KDE plots</strong> (or <strong>2D KDE plots</strong>) to show anestimated, smooth distribution of a single numerical variable (or two numerical variables).</li>
<li><code>sns.jointplot</code>- This command is useful for simultaneously displaying a 2D KDE plot with the correspoinding KDE plots for each individual variable.</li>
</ul>
</li>
</ul>
</li>
<li><p>Set styles for the figure</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sns.set_style(<span class="string">"dark"</span>)	<span class="comment"># set dark style for the figure, five themes: "darkgrid", "whitegrid", "dark", "white", "ticks". The default theme is "darkgrid"</span></span><br><span class="line">plt.figure(figure=(<span class="number">12</span>,<span class="number">6</span>))	<span class="comment"># change the figure size</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Countplot (doesn’t require us to shape the data)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.countplot(reviews[<span class="string">'points'</span>])</span><br></pre></td></tr></table></figure>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-11.png" style="zoom:70%"><br></center>
</li>
<li><p>KDE plot (kernel density estimate), worse choice for ordinal categorical data, KDE plot will fit to something that doesn’t exist.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.kdeplot(reviews.query(<span class="string">'price &lt; 200'</span>).price)</span><br></pre></td></tr></table></figure>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-12.png" style="zoom:70%"><br></center>
</li>
<li><p>Bivariate hex plot</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.jointplot(x=<span class="string">'price'</span>, y=<span class="string">'points'</span>, data=reviews[reviews[<span class="string">'price'</span>] &lt; <span class="number">100</span>], kind=<span class="string">'hex'</span>, gridsize=<span class="number">20</span>)</span><br></pre></td></tr></table></figure>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-13.png" style="zoom:70%"><br></center>
</li>
<li><p>Boxplot</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df = reviews[reviews.variety.isin(reviews.variety.value_counts().head(<span class="number">5</span>).index)]</span><br><span class="line"></span><br><span class="line">sns.boxplot(</span><br><span class="line">    x=<span class="string">'variety'</span>,</span><br><span class="line">    y=<span class="string">'points'</span>,</span><br><span class="line">    data=df</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-14.png" style="zoom:70%"><br></center>

<p>The center of the distributions shown above is the “box” in boxplot. The top of the box is the 75th percentile, while the bottom is the 25th percentile. In other words, half of the data is distributed within the box. The green line in the middle is the median. (50% of the data in the distribution is located within the box)</p>
<p>The other part of the plot, the “whiskers”, shows the extent of the points beyond the center of the distribution. Individual circles beyond that are outliers.</p>
<p>Boxplots are great for summarizing the shape of many datasets. They also don’t have a limit in terms of numeracy: you can place as many boxes in the plot as you feel comfortable squeezing onto the page.</p>
<p>However, they only work for interval variables and nomial variables and nominal variables with a large number of possible values and they don’t carry any information about individual values, only treating the distribution as a whole. </p>
</li>
<li><p>Violinplot</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sns.violinplot(</span><br><span class="line">    x=<span class="string">'variety'</span>,</span><br><span class="line">    y=<span class="string">'points'</span>,</span><br><span class="line">    data=reviews[reviews.variety.isin(reviews.variety.value_counts()[:<span class="number">5</span>].index)]</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-15.png" style="zoom:70%"><br></center>

<p>Harder to misinterpret and much prettier than the utilitarian boxplot</p>
</li>
<li><p>Facet</p>
<center><br>    <img src="https://azure-pictures.s3.amazonaws.com/blog/2019-04-30-16.png" style="zoom:60%"><br></center>





</li>
</ul>
<h1 id="Deep-Learning"><a href="#Deep-Learning" class="headerlink" title="Deep Learning"></a>Deep Learning</h1><ul>
<li><p>Transfer Learning</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.python.keras.applications <span class="keyword">import</span> ResNet50</span><br><span class="line"><span class="keyword">from</span> tensorflow.python.keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> tensorflow.python.keras.layers <span class="keyword">import</span> Dense, Flatten, GlobalAveragePooling2D</span><br><span class="line"></span><br><span class="line">num_classes = <span class="number">2</span></span><br><span class="line">resnet_weights_path = <span class="string">'../input/resnet50/resnet50_weights_tf_dim_ordering_tf_kernels_notop.h5'</span></span><br><span class="line"></span><br><span class="line">my_new_model = Sequential()</span><br><span class="line">my_new_model.add(ResNet50(include_top=<span class="keyword">False</span>, pooling=<span class="string">'avg'</span>, weights=resnet_weights_path))</span><br><span class="line">my_new_model.add(Dense(num_classes, activation=<span class="string">'softmax'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Say not to train first layer (ResNet) model. It is already trained</span></span><br><span class="line">my_new_model.layers[<span class="number">0</span>].trainable = <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Compipe model</span></span><br><span class="line">my_new_model.compile(optimizer=<span class="string">'sgd'</span>, loss=<span class="string">'categorical_crossentropy'</span>, metrics=[<span class="string">'accuracy'</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tensorflow.python.keras.applications.resnet50 <span class="keyword">import</span> preprocess_input</span><br><span class="line"><span class="keyword">from</span> tensorflow.python.keras.preprocessing.image <span class="keyword">import</span> ImageDataGenerator</span><br><span class="line"></span><br><span class="line">image_size = <span class="number">224</span></span><br><span class="line">data_generator = ImageDataGenerator(preprocessing_function=preprocess_input)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fit model</span></span><br><span class="line">train_generator = data_generator.flow_from_directory(</span><br><span class="line">        <span class="string">'../input/urban-and-rural-photos/rural_and_urban_photos/train'</span>,</span><br><span class="line">        target_size=(image_size, image_size),</span><br><span class="line">        batch_size=<span class="number">24</span>,</span><br><span class="line">        class_mode=<span class="string">'categorical'</span>)</span><br><span class="line"></span><br><span class="line">validation_generator = data_generator.flow_from_directory(</span><br><span class="line">        <span class="string">'../input/urban-and-rural-photos/rural_and_urban_photos/val'</span>,</span><br><span class="line">        target_size=(image_size, image_size),</span><br><span class="line">        class_mode=<span class="string">'categorical'</span>)</span><br><span class="line"></span><br><span class="line">my_new_model.fit_generator(</span><br><span class="line">        train_generator,</span><br><span class="line">        steps_per_epoch=<span class="number">3</span>,</span><br><span class="line">        validation_data=validation_generator,</span><br><span class="line">        validation_steps=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="Relate-CoLab-and-Google-Drive"><a href="#Relate-CoLab-and-Google-Drive" class="headerlink" title="Relate CoLab and Google Drive"></a>Relate CoLab and Google Drive</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">!apt-get install -y -qq software-properties-common python-software-properties module-init-tools</span><br><span class="line">!add-apt-repository -y ppa:alessandro-strada/ppa 2&gt;&amp;1 &gt; /dev/null</span><br><span class="line">!apt-get update -qq 2&gt;&amp;1 &gt; /dev/null</span><br><span class="line">!apt-get -y install -qq google-drive-ocamlfuse fuse</span><br><span class="line">from google.colab import auth</span><br><span class="line">auth.authenticate_user()</span><br><span class="line">from oauth2client.client import GoogleCredentials</span><br><span class="line">creds = GoogleCredentials.get_application_default()</span><br><span class="line">import getpass</span><br><span class="line">!google-drive-ocamlfuse -headless -id=&#123;creds.client_id&#125; -secret=&#123;creds.client_secret&#125; &lt; /dev/null 2&gt;&amp;1 | grep URL</span><br><span class="line">vcode = getpass.getpass()</span><br><span class="line">!echo &#123;vcode&#125; | google-drive-ocamlfuse -headless -id=&#123;creds.client_id&#125; -secret=&#123;creds.client_secret&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># specify Google Drive root directory，名为drive</span><br><span class="line">!mkdir -p drive</span><br><span class="line">!google-drive-ocamlfuse drive</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">os.chdir(&quot;drive/Colab Notebooks&quot;)</span><br></pre></td></tr></table></figure>
<p>Success!</p>

      
    </div>

    

    
    
    

    <div>
    
    <div>

    <div style="text-align:center;color: #ccc;font-size:14px;">-------------End of the article <i class="fa fa-paw"></i> Thanks for reading!-------------</div>

</div>
    
    </div>

    

    
       
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Programming/" rel="tag"><i class="fa fa-tag"></i> Programming</a>
          
            <a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a>
          
            <a href="/tags/Deep-Learning/" rel="tag"><i class="fa fa-tag"></i> Deep Learning</a>
          
            <a href="/tags/TensorFlow/" rel="tag"><i class="fa fa-tag"></i> TensorFlow</a>
          
            <a href="/tags/Keras/" rel="tag"><i class="fa fa-tag"></i> Keras</a>
          
            <a href="/tags/Machine-Learning/" rel="tag"><i class="fa fa-tag"></i> Machine Learning</a>
          
            <a href="/tags/Scikit-learn/" rel="tag"><i class="fa fa-tag"></i> Scikit-learn</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/04/24/Structuring Machine Learning Projects/" rel="next" title="Structuring Machine Learning Projects">
                <i class="fa fa-chevron-left"></i> Structuring Machine Learning Projects
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/04/25/Convolutional Neural Networks/" rel="prev" title="Convolutional Neural Networks">
                Convolutional Neural Networks <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div id="gitalk-container"></div>  
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Qingliu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">20</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">2</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">21</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/Aden-Q" title="GitHub &rarr; https://github.com/Aden-Q" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:qian0102@umn.edu" title="E-Mail &rarr; mailto:qian0102@umn.edu" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://www.linkedin.com/in/azure-qian-11b128179" title="Linkedin &rarr; https://www.linkedin.com/in/azure-qian-11b128179" rel="noopener" target="_blank"><i class="fa fa-fw fa-linkedin"></i>Linkedin</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://www.facebook.com/zecheng.qian.7" title="FB Page &rarr; https://www.facebook.com/zecheng.qian.7" rel="noopener" target="_blank"><i class="fa fa-fw fa-facebook"></i>FB Page</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ML-Methods"><span class="nav-number">1.</span> <span class="nav-text">ML Methods</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Pandas"><span class="nav-number">2.</span> <span class="nav-text">Pandas</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Seaborn"><span class="nav-number">3.</span> <span class="nav-text">Seaborn</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Deep-Learning"><span class="nav-number">4.</span> <span class="nav-text">Deep Learning</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Relate-CoLab-and-Google-Drive"><span class="nav-number">5.</span> <span class="nav-text">Relate CoLab and Google Drive</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Qingliu</span>

  

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
    Number of visitors: <span id="busuanzi_value_site_uv"></span>
</span>
</div>


<!--
<span class="post-meta-divider">|</span>



  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v6.5.0</div>



-->

<span class="post-meta-divider">|</span>

<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">Total 34.7k words</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>












  



  
    
      
  
  <script type="text/javascript" color="0,0,0" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script>













  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.5.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.5.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.5.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.5.0"></script>



  



  









  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
   <script type="text/javascript">
        var gitalk = new Gitalk({
          clientID: '69ff68eec89b6cd91e37',
          clientSecret: '200633852bdb3579481b3fecee7178c1b98f471e',
          repo: 'gitalk-comments',
          owner: 'Aden-Q',
          admin: ['Aden-Q'],
          id: location.pathname,
          distractionFreeMode: 'true'
        })
        gitalk.render('gitalk-container')           
       </script>


  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script>
    
    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url }) })
        .done(function ({ results }) {
          if (results.length > 0) {
            var counter = results[0];
            
            Counter('put', `/classes/Counter/${counter.objectId}`, JSON.stringify({ time: { "__op":"Increment", "amount":1 } }))
            
            .done(function () {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(counter.time + 1);
            })
            
            .fail(function ({ responseJSON }) {
                console.log('Failed to save Visitor num, with error message: ' + responseJSON.error);
            })
          } else {
            
              Counter('post', '/classes/Counter', JSON.stringify({ title: title, url: url, time: 1}))
                .done(function () {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(1);
                })
                .fail(function () {
                  console.log('Failed to create');
                });
            
          }
        })
      .fail(function ({ responseJSON }) {
        console.log('LeanCloud Counter Error:' + responseJSON.code + " " + responseJSON.error);
      });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + "TTkRYLVAOPvuxQuV5scOHl9U-gzGzoHsz")
        .done(function ({ api_server }) {
          var Counter = function (method, url, data) {
            return $.ajax({
              method: method,
              url: `https://${api_server}/1.1${url}`,
              headers: {
                'X-LC-Id': "TTkRYLVAOPvuxQuV5scOHl9U-gzGzoHsz",
                'X-LC-Key': "fCRGgKjo3tYIfbW3ygKrNCRN",
                'Content-Type': 'application/json',
              },
              data: data,
            });
          };
          
          addCount(Counter);
          
        })
    });
  </script>



  

  

  

  
  

  
  

  
    
      <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      },
      TeX: {equationNumbers: { autoNumber: "AMS" }}
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    
  


  
  

  

  

  

  

  

  


</body>
</html>
